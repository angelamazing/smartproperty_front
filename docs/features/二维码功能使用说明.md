# 📱 二维码功能使用说明

## 📖 功能概述

二维码功能是智慧物业管理系统中的核心功能之一，为用户提供便捷的就餐登记方式。用户通过扫描餐厅张贴的二维码，系统自动判断餐次并完成就餐登记，大大简化了就餐流程。

## 🎯 核心特性

### ✅ 自动餐次判断
- **早餐时间**: 6:00-10:00
- **午餐时间**: 11:00-14:00  
- **晚餐时间**: 17:00-20:00
- 系统根据扫码时间自动识别当前餐次

### ✅ 智能业务验证
- 检查用户是否已报餐
- 验证二维码有效性
- 防止重复登记
- 时间范围验证

### ✅ 完整的数据统计
- 扫码次数统计
- 成功率分析
- 用户使用趋势
- 二维码使用情况

## 🚀 用户使用指南

### 1. 扫码就餐流程

#### 步骤一：确保已报餐
- ⚠️ **重要**: 只有部门管理员可以为部门成员报餐
- 普通用户无法自行报餐，需要联系部门管理员代为报餐
- 在扫码前请确认已报餐状态

#### 步骤二：选择扫码方式
1. **自动扫码**: 点击"开始扫码"按钮，使用摄像头扫描二维码
2. **手动输入**: 点击"手动输入"按钮，直接输入二维码内容
3. **选择二维码**: 从可用二维码列表中选择并点击使用

#### 步骤三：完成扫码
- 将二维码对准扫描框
- 系统自动识别二维码内容
- 验证业务规则（报餐状态、时间范围等）
- 显示扫码结果

### 2. 扫码界面功能

#### 今日就餐概览
- 显示当前日期的各餐次状态
- 绿色圆点：已报餐
- 蓝色圆点：已扫码
- 蓝色边框：当前餐次时间
- 点击餐次可查看详细信息

#### 可用二维码列表
- 显示所有启用的二维码
- 包含二维码名称、位置、内容
- 点击可查看详细信息
- 支持直接使用二维码

#### 扫码提示
- ✅ 确保已报餐
- ⏰ 在就餐时间内扫码
- 📱 保持二维码清晰可见

### 3. 扫码结果处理

#### 成功扫码
- 显示"登记成功"消息
- 包含餐次、时间、位置信息
- 自动刷新今日概览和历史记录

#### 扫码失败
- 显示具体失败原因
- 常见错误及解决方案：
  - "您尚未报餐，无法进行就餐登记" → 联系部门管理员报餐
  - "当前时间不在就餐时间内" → 在就餐时间内扫码
  - "您已登记过本次就餐" → 无需重复扫码
  - "二维码无效或已停用" → 使用有效的二维码

## 🔧 管理员功能

### 1. 二维码管理

#### 创建二维码
1. 点击"创建二维码"按钮
2. 填写二维码信息：
   - **名称**: 二维码的显示名称（必填）
   - **位置**: 张贴位置描述（必填）
   - **描述**: 详细说明（可选）
3. 系统自动生成唯一二维码标识
4. 打印并张贴在指定位置

#### 二维码列表管理
- 查看所有二维码的基本信息
- 显示使用统计数据
- 支持状态切换（启用/停用）
- 批量操作功能

#### 批量操作
- **批量选择**: 点击二维码左侧的选择框
- **批量启用**: 同时启用多个二维码
- **批量停用**: 同时停用多个二维码
- **批量删除**: 删除选中的二维码（谨慎操作）

### 2. 数据统计与分析

#### 统计概览
- **总二维码数**: 系统中所有二维码数量
- **启用中**: 当前启用的二维码数量
- **总扫码次数**: 所有二维码的扫码总数
- **今日扫码**: 当天的扫码次数

#### 二维码详情
- 扫码次数统计
- 成功率分析
- 独立用户数
- 最近7天使用趋势图

#### 使用趋势分析
- 柱状图显示最近7天的扫码情况
- 鼠标悬停显示具体数据
- 帮助分析二维码使用热度

### 3. 历史记录管理

#### 扫码历史查看
- 按日期范围筛选
- 按餐次类型筛选
- 按扫码状态筛选
- 支持分页加载

#### 记录详情
- 完整的扫码信息
- 二维码详细信息
- 失败原因分析
- 时间戳记录

## 📋 业务规则

### 扫码登记规则

1. **时间限制**
   - 只有在就餐时间内扫码才能成功登记
   - 早餐：6:00-10:00
   - 午餐：11:00-14:00
   - 晚餐：17:00-20:00

2. **报餐验证**
   - 用户必须先报餐才能进行就餐登记
   - 只有部门管理员可以为部门成员报餐
   - 普通用户无法自行报餐

3. **重复登记**
   - 同一用户同一餐次只能登记一次
   - 系统自动检测并阻止重复扫码

4. **二维码有效性**
   - 只有状态为"active"的二维码才能使用
   - 停用的二维码无法扫码

### 错误处理

| 错误信息 | 原因 | 解决方案 |
|---------|------|---------|
| 当前时间不在就餐时间内 | 扫码时间不在规定就餐时间内 | 在就餐时间内扫码 |
| 您尚未报餐，无法进行就餐登记 | 用户没有报餐记录 | 联系部门管理员代为报餐 |
| 您已登记过本次就餐 | 用户已经登记过该餐次 | 无需重复登记 |
| 二维码无效或已停用 | 二维码不存在或已停用 | 使用有效的二维码 |
| 用户不存在或已被禁用 | 用户账号异常 | 联系管理员检查账号状态 |

## 🔒 安全考虑

### 权限控制
- 所有接口都需要相应的权限验证
- 用户只能查看自己的扫码记录
- 管理员可以管理所有二维码

### 数据验证
- 严格的参数验证和业务规则检查
- 防止恶意扫码和重复操作
- 完整的操作日志记录

### 防重复机制
- 防止重复登记
- 防止恶意扫码
- 时间窗口限制

## 📊 数据统计

### 用户端统计
- 个人扫码历史记录
- 各餐次扫码统计
- 扫码成功率分析

### 管理员统计
- 全局扫码数据
- 二维码使用情况
- 用户活跃度分析
- 趋势图表展示

## 🛠️ 技术实现

### 前端技术
- Vue.js 3 + uni-app框架
- 响应式设计，支持多端适配
- 实时数据更新和状态管理
- 优雅的动画效果和交互体验

### 后端接口
- RESTful API设计
- JWT Token认证
- 完整的错误处理机制
- 数据缓存和性能优化

### 数据库设计
- 二维码管理表（qr_codes）
- 就餐登记表（dining_registrations）
- 用户表关联和索引优化

## 📱 使用场景

### 餐厅场景
1. 管理员创建二维码并张贴在餐厅各位置
2. 用户到达餐厅后扫描二维码
3. 系统自动完成就餐登记
4. 管理员可查看实时就餐数据

### 办公场景
1. 在办公区域张贴二维码
2. 员工扫码完成就餐登记
3. 便于统计和管理员工就餐情况

### 活动场景
1. 在活动现场张贴二维码
2. 参与者扫码登记
3. 实时统计参与人数

## 🔄 更新日志

### v2.0.0 (2025-01-XX)
- ✅ 优化扫码界面UI/UX设计
- ✅ 增加二维码历史记录查看页面
- ✅ 完善二维码管理界面功能
- ✅ 增加批量操作功能
- ✅ 添加使用趋势图表
- ✅ 优化扫码结果展示和反馈机制
- ✅ 完善帮助文档和使用说明

### v1.0.0 (2025-01-XX)
- ✅ 基础扫码功能实现
- ✅ 二维码管理功能
- ✅ 基本数据统计功能

## 📞 技术支持

如果在使用过程中遇到问题，请联系技术支持团队：

- **技术支持邮箱**: support@example.com
- **技术支持电话**: 400-xxx-xxxx
- **在线帮助**: 系统内置帮助功能

---

**文档版本**: v2.0.0  
**最后更新**: 2025年1月  
**维护团队**: 湖北省地质局第三地质大队
