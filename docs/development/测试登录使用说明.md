# 智慧物业管理系统 - 测试登录使用说明

## 概述

为解决测试环境缺少不同权限用户的问题，我们新增了三种测试登录方式：

## 1. 测试登录类型

### 🧪 普通用户测试登录
- **角色**: `user`（普通用户）
- **权限**: 基础功能（报餐、预约、查看个人信息）
- **使用场景**: 测试普通用户功能

### 👨‍💼 部门管理员测试登录
- **角色**: `dept_admin`（部门管理员）
- **权限**:
  - ✅ 管理部门成员报餐
  - ✅ 审核特殊预约申请
  - ✅ 查看部门统计数据
  - ✅ 管理场地预约（部分权限）
- **使用场景**: 测试部门管理功能

### 👑 系统管理员测试登录
- **角色**: `sys_admin`（系统管理员）
- **权限**:
  - ✅ 所有用户管理权限
  - ✅ 系统配置管理
  - ✅ 所有业务模块管理
  - ✅ 数据统计查看
  - ✅ 用餐验证管理
- **使用场景**: 测试所有管理功能

## 2. 使用方法

### 前端使用步骤

1. **启动开发环境**
   ```bash
   npm run dev
   ```

2. **访问登录页面**
   - 打开小程序/应用
   - 进入登录页面

3. **选择测试登录类型**
   - 点击"测试登录" - 普通用户权限
   - 点击"管理员测试" - 部门管理员权限
   - 点击"系统管理员测试" - 系统管理员权限

4. **确认登录**
   - 系统会弹出确认对话框
   - 点击确认后自动登录
   - 显示登录成功提示

### 后端接口说明

#### 普通用户测试登录
```javascript
POST /api/auth/test-login
// 返回普通用户权限的测试账号
```

#### 部门管理员测试登录
```javascript
POST /api/auth/test-login-admin
// 返回部门管理员权限的测试账号
```

#### 系统管理员测试登录
```javascript
POST /api/auth/test-login-sys-admin
// 返回系统管理员权限的测试账号
```

## 3. 功能验证

### 普通用户可测试的功能
- ✅ 日常报餐
- ✅ 特殊预约报餐
- ✅ 球馆预约
- ✅ 个人中心
- ✅ 基础信息查看

### 部门管理员可测试的功能
- ✅ 所有普通用户功能
- ✅ 部门成员管理
- ✅ 报餐订单管理
- ✅ 特殊预约审核
- ✅ 部门统计查看
- ✅ 场地预约管理（部分）

### 系统管理员可测试的功能
- ✅ 所有部门管理员功能
- ✅ 用户管理（增删改查）
- ✅ 系统配置管理
- ✅ 数据统计分析
- ✅ 用餐验证管理
- ✅ 公告管理

## 4. 注意事项

### ⚠️ 重要提醒

1. **仅开发环境可用**
   - 这些测试接口仅在开发环境工作
   - 生产环境会返回403错误

2. **测试数据隔离**
   - 测试用户数据不会影响生产数据
   - 测试Token有效期为24小时

3. **权限范围**
   - 严格按照角色权限控制功能访问
   - 超出权限的操作会返回403错误

### 🔧 技术说明

1. **Token管理**
   - 测试Token包含特殊标识
   - 可以通过 `isTestUser` 字段识别测试用户

2. **数据清理**
   - 系统会定期清理过期的测试数据
   - 建议测试完成后主动退出登录

## 5. 常见问题

### Q: 测试登录按钮不显示？
A: 确认当前是开发环境，生产环境不会显示测试登录按钮

### Q: 登录后提示权限不足？
A: 检查用户角色是否正确，不同角色有不同权限范围

### Q: 测试数据会被保存到数据库吗？
A: 测试数据会保存，但会被标记为测试数据，定期清理

### Q: 如何切换不同权限进行测试？
A: 退出当前登录，重新选择其他测试登录方式

## 6. 后端开发协作

如果您是后端开发人员，请参考以下文档：

- 📄 `后端接口新增需求.md` - 详细接口需求说明
- 📄 `后端实现示例.js` - 完整实现代码示例
- 📄 `后端接口文档.md` - 完整的接口文档

## 7. 技术支持

如有技术问题，请联系开发团队：

- 📧 邮箱：tech-support@example.com
- 📱 电话：400-123-4567
- 💬 微信群：智慧物业技术交流群

---

**最后更新**: 2025年9月7日
**版本**: v1.0.0
