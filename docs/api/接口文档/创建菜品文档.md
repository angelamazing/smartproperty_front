# èœå“åˆ›å»ºæ¥å£æ–‡æ¡£

## ğŸ“‹ æ¥å£æ¦‚è¿°

**æ¥å£åç§°**: åˆ›å»ºèœå“  
**æ¥å£è·¯å¾„**: `POST /api/admin/dishes`  
**è¯·æ±‚æ–¹å¼**: `POST`  
**æ¥å£æè¿°**: ç®¡ç†å‘˜åˆ›å»ºæ–°èœå“ï¼Œæ”¯æŒå®Œæ•´çš„èœå“ä¿¡æ¯å½•å…¥  
**æƒé™è¦æ±‚**: éœ€è¦ç®¡ç†å‘˜æƒé™ï¼ˆ`requireDeptAdmin`ï¼‰

## ğŸ” æƒé™éªŒè¯

- **èº«ä»½éªŒè¯**: éœ€è¦æœ‰æ•ˆçš„ JWT Token
- **æƒé™è¦æ±‚**: éƒ¨é—¨ç®¡ç†å‘˜æƒé™
- **Token æ ¼å¼**: `Bearer <token>`

## ğŸ“¥ è¯·æ±‚å‚æ•°

### è¯·æ±‚å¤´
```http
Content-Type: application/json
Authorization: Bearer <your-jwt-token>
```

### è¯·æ±‚ä½“å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|--------|------|------|
| name | string | âœ… | - | èœå“åç§°ï¼Œæœ€å¤§100å­—ç¬¦ | "å®«ä¿é¸¡ä¸" |
| categoryId | string | âœ… | - | èœå“åˆ†ç±»ID | "2" |
| description | string | âŒ | null | èœå“æè¿°ï¼Œæœ€å¤§500å­—ç¬¦ | "ç»å…¸å·èœï¼Œéº»è¾£é²œé¦™" |
| price | number | âŒ | 0 | èœå“ä»·æ ¼ï¼Œå¿…é¡»â‰¥0 | 25.5 |
| image | string | âŒ | null | èœå“å›¾ç‰‡URL | "https://example.com/dish.jpg" |
| calories | number | âŒ | null | å¡è·¯é‡Œå«é‡ | 350 |
| protein | number | âŒ | null | è›‹ç™½è´¨å«é‡(g) | 25.5 |
| fat | number | âŒ | null | è„‚è‚ªå«é‡(g) | 15.2 |
| carbohydrate | number | âŒ | null | ç¢³æ°´åŒ–åˆç‰©å«é‡(g) | 45.8 |
| tags | array | âŒ | [] | èœå“æ ‡ç­¾æ•°ç»„ | ["å·èœ", "è¾£", "ä¸‹é¥­"] |
| status | string | âŒ | "active" | èœå“çŠ¶æ€ | "active" æˆ– "inactive" |
| isRecommended | boolean | âŒ | false | æ˜¯å¦æ¨èèœå“ | true æˆ– false |

### å‚æ•°éªŒè¯è§„åˆ™

#### å¿…å¡«å­—æ®µéªŒè¯
- `name`: ä¸èƒ½ä¸ºç©ºï¼Œæœ€å¤§é•¿åº¦100å­—ç¬¦
- `categoryId`: ä¸èƒ½ä¸ºç©º

#### å¯é€‰å­—æ®µéªŒè¯
- `description`: æœ€å¤§é•¿åº¦500å­—ç¬¦
- `price`: å¿…é¡»â‰¥0çš„æµ®ç‚¹æ•°
- `image`: å¿…é¡»æ˜¯æœ‰æ•ˆçš„URLæ ¼å¼
- `calories`: å¿…é¡»â‰¥0çš„æµ®ç‚¹æ•°
- `protein`: å¿…é¡»â‰¥0çš„æµ®ç‚¹æ•°
- `fat`: å¿…é¡»â‰¥0çš„æµ®ç‚¹æ•°
- `carbohydrate`: å¿…é¡»â‰¥0çš„æµ®ç‚¹æ•°
- `tags`: å¿…é¡»æ˜¯æ•°ç»„æ ¼å¼
- `status`: åªèƒ½æ˜¯ "active" æˆ– "inactive"
- `isRecommended`: å¿…é¡»æ˜¯å¸ƒå°”å€¼

## ğŸ“¤ å“åº”æ ¼å¼

### æˆåŠŸå“åº”

**HTTPçŠ¶æ€ç **: `200 OK`

```json
{
  "success": true,
  "message": "åˆ›å»ºèœå“æˆåŠŸ",
  "code": "200",
  "timestamp": "2025-09-04T12:00:00.000Z",
  "data": {
    "id": "dish-uuid-here",
    "name": "å®«ä¿é¸¡ä¸",
    "price": 25.5,
    "status": "active"
  }
}
```

### é”™è¯¯å“åº”

#### å‚æ•°éªŒè¯é”™è¯¯
**HTTPçŠ¶æ€ç **: `400 Bad Request`

```json
{
  "success": false,
  "message": "å‚æ•°éªŒè¯å¤±è´¥",
  "code": "400",
  "timestamp": "2025-09-04T12:00:00.000Z",
  "errors": [
    {
      "field": "name",
      "message": "èœå“åç§°ä¸èƒ½ä¸ºç©ºä¸”ä¸è¶…è¿‡100å­—ç¬¦"
    },
    {
      "field": "price",
      "message": "ä»·æ ¼å¿…é¡»å¤§äºç­‰äº0"
    }
  ]
}
```

#### æƒé™ä¸è¶³
**HTTPçŠ¶æ€ç **: `403 Forbidden`

```json
{
  "success": false,
  "message": "æƒé™ä¸è¶³",
  "code": "403",
  "timestamp": "2025-09-04T12:00:00.000Z"
}
```

#### æœåŠ¡å™¨é”™è¯¯
**HTTPçŠ¶æ€ç **: `500 Internal Server Error`

```json
{
  "success": false,
  "message": "åˆ›å»ºèœå“å¤±è´¥",
  "code": "500",
  "timestamp": "2025-09-04T12:00:00.000Z",
  "error": "å…·ä½“é”™è¯¯ä¿¡æ¯"
}
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: åˆ›å»ºåŸºç¡€èœå“

```bash
curl -X POST http://localhost:3000/api/admin/dishes \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-jwt-token" \
  -d '{
    "name": "å®«ä¿é¸¡ä¸",
    "categoryId": "2",
    "description": "ç»å…¸å·èœï¼Œéº»è¾£é²œé¦™",
    "price": 25.5
  }'
```

**å“åº”**:
```json
{
  "success": true,
  "message": "åˆ›å»ºèœå“æˆåŠŸ",
  "data": {
    "id": "dish-uuid-here",
    "name": "å®«ä¿é¸¡ä¸",
    "price": 25.5,
    "status": "active"
  }
}
```

### ç¤ºä¾‹2: åˆ›å»ºå®Œæ•´ä¿¡æ¯èœå“

```bash
curl -X POST http://localhost:3000/api/admin/dishes \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-jwt-token" \
  -d '{
    "name": "çº¢çƒ§è‚‰",
    "categoryId": "1",
    "description": "è‚¥ç˜¦ç›¸é—´çš„äº”èŠ±è‚‰ï¼Œè‰²æ³½çº¢äº®ï¼Œå£æ„Ÿè½¯ç³¯",
    "price": 35.0,
    "image": "https://example.com/hongshao-rou.jpg",
    "calories": 450,
    "protein": 28.5,
    "fat": 32.1,
    "carbohydrate": 8.5,
    "tags": ["é²èœ", "ç»å…¸", "ä¸‹é¥­"],
    "status": "active",
    "isRecommended": true
  }'
```

### ç¤ºä¾‹3: åˆ›å»ºç®€å•èœå“ï¼ˆæœ€å°‘å‚æ•°ï¼‰

```bash
curl -X POST http://localhost:3000/api/admin/dishes \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-jwt-token" \
  -d '{
    "name": "ç™½ç±³é¥­",
    "categoryId": "3"
  }'
```

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### æ•°æ®åº“è¡¨ç»“æ„

```sql
CREATE TABLE dishes (
  _id VARCHAR(36) PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  categoryId VARCHAR(36) NOT NULL,
  description TEXT,
  price DECIMAL(10,2) DEFAULT 0,
  image VARCHAR(500),
  calories DECIMAL(8,2),
  protein DECIMAL(8,2),
  fat DECIMAL(8,2),
  carbohydrate DECIMAL(8,2),
  tags JSON,
  status ENUM('active', 'inactive') DEFAULT 'active',
  isRecommended TINYINT(1) DEFAULT 0,
  createTime DATETIME DEFAULT CURRENT_TIMESTAMP,
  updateTime DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  createBy VARCHAR(36),
  updateBy VARCHAR(36)
);
```

### å‚æ•°å¤„ç†é€»è¾‘

1. **å‚æ•°éªŒè¯**: ä½¿ç”¨ `express-validator` è¿›è¡Œè¾“å…¥éªŒè¯
2. **æ•°æ®æ¸…ç†**: å°† `undefined` å€¼è½¬æ¢ä¸º `null`
3. **ç±»å‹è½¬æ¢**: å¸ƒå°”å€¼è½¬æ¢ä¸ºæ•°å­—ï¼ˆ0/1ï¼‰
4. **é»˜è®¤å€¼å¤„ç†**: ä¸ºå¯é€‰å­—æ®µæä¾›åˆé€‚çš„é»˜è®¤å€¼

### é”™è¯¯å¤„ç†

- **å‚æ•°éªŒè¯é”™è¯¯**: è¿”å›è¯¦ç»†çš„å­—æ®µéªŒè¯ä¿¡æ¯
- **æ•°æ®åº“é”™è¯¯**: è®°å½•é”™è¯¯æ—¥å¿—å¹¶è¿”å›é€šç”¨é”™è¯¯ä¿¡æ¯
- **æƒé™é”™è¯¯**: è¿”å›æƒé™ä¸è¶³æç¤º

## ğŸ“Š çŠ¶æ€ç è¯´æ˜

| çŠ¶æ€ç  | è¯´æ˜ | åœºæ™¯ |
|--------|------|------|
| 200 | æˆåŠŸ | èœå“åˆ›å»ºæˆåŠŸ |
| 400 | è¯·æ±‚é”™è¯¯ | å‚æ•°éªŒè¯å¤±è´¥ |
| 401 | æœªæˆæƒ | Tokenæ— æ•ˆæˆ–è¿‡æœŸ |
| 403 | ç¦æ­¢è®¿é—® | æƒé™ä¸è¶³ |
| 500 | æœåŠ¡å™¨é”™è¯¯ | æ•°æ®åº“æ“ä½œå¤±è´¥æˆ–å…¶ä»–ç³»ç»Ÿé”™è¯¯ |

## ğŸš¨ æ³¨æ„äº‹é¡¹

### 1. å‚æ•°è¦æ±‚
- æ‰€æœ‰å¿…å¡«å­—æ®µå¿…é¡»æä¾›
- æ•°å€¼ç±»å‹å­—æ®µä¸èƒ½ä¸ºè´Ÿæ•°
- å­—ç¬¦ä¸²å­—æ®µä¸èƒ½è¶…è¿‡æœ€å¤§é•¿åº¦é™åˆ¶

### 2. æ•°æ®æ ¼å¼
- ä»·æ ¼ä½¿ç”¨æµ®ç‚¹æ•°ï¼Œæ”¯æŒå°æ•°ç‚¹
- è¥å…»æˆåˆ†ä½¿ç”¨æµ®ç‚¹æ•°ï¼Œç²¾ç¡®åˆ°å°æ•°ç‚¹å2ä½
- æ ‡ç­¾ä½¿ç”¨JSONæ•°ç»„æ ¼å¼

### 3. æƒé™æ§åˆ¶
- åªæœ‰éƒ¨é—¨ç®¡ç†å‘˜å¯ä»¥åˆ›å»ºèœå“
- éœ€è¦æœ‰æ•ˆçš„JWT Token
- Tokenå¿…é¡»åŒ…å«æ­£ç¡®çš„æƒé™ä¿¡æ¯

### 4. æ€§èƒ½è€ƒè™‘
- å›¾ç‰‡URLå»ºè®®ä½¿ç”¨CDNåœ°å€
- å¤§é‡æ ‡ç­¾å¯èƒ½å½±å“æŸ¥è¯¢æ€§èƒ½
- å»ºè®®å®šæœŸæ¸…ç†æ— æ•ˆçš„èœå“æ•°æ®

## ğŸ”„ ç›¸å…³æ¥å£

- **è·å–èœå“åˆ—è¡¨**: `GET /api/admin/dishes`
- **è·å–èœå“è¯¦æƒ…**: `GET /api/admin/dishes/:dishId`
- **æ›´æ–°èœå“**: `PUT /api/admin/dishes/:dishId`
- **åˆ é™¤èœå“**: `DELETE /api/admin/dishes/:dishId`
- **è·å–èœå“åˆ†ç±»**: `GET /api/admin/dish-categories`

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-09-04)
- âœ… åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… æ”¯æŒå®Œæ•´çš„èœå“ä¿¡æ¯åˆ›å»º
- âœ… æ·»åŠ å‚æ•°éªŒè¯å’Œé”™è¯¯å¤„ç†
- âœ… ä¿®å¤å‚æ•°ç»‘å®šé”™è¯¯é—®é¢˜
- âœ… å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹

---

**æœ€åæ›´æ–°**: 2025-09-04  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**ç»´æŠ¤äººå‘˜**: å¼€å‘å›¢é˜Ÿ
