# æ™ºæ…§ç‰©ä¸šç®¡ç†ç³»ç»Ÿ - éƒ¨é—¨ç®¡ç†APIæ–‡æ¡£ v3.0

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†æ™ºæ…§ç‰©ä¸šç®¡ç†ç³»ç»Ÿçš„éƒ¨é—¨ç®¡ç†åŠŸèƒ½APIæ¥å£ï¼ŒåŒ…æ‹¬éƒ¨é—¨ç®¡ç†ã€éƒ¨é—¨ç®¡ç†å‘˜æƒé™æ§åˆ¶ã€å¢å¼ºç‰ˆæŠ¥é¤åŠŸèƒ½ç­‰ã€‚ç³»ç»Ÿæ”¯æŒ9ä¸ªéƒ¨é—¨çš„ç‹¬ç«‹ç®¡ç†ï¼Œæ¯ä¸ªéƒ¨é—¨éƒ½æœ‰ä¸“é—¨çš„ç®¡ç†å‘˜è´Ÿè´£æŠ¥é¤ã€‚

## ğŸ” è®¤è¯è¯´æ˜

æ‰€æœ‰APIæ¥å£éƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦JWT Tokenï¼š

```http
Authorization: Bearer {your_jwt_token}
```

### è·å–Tokençš„æ–¹å¼

#### 1. æµ‹è¯•ç™»å½•ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
```http
POST /api/auth/test-login-admin
Content-Type: application/json

{
  "phoneNumber": "13800001001",
  "password": "123456"
}
```

#### 2. æ‰‹æœºå·ç™»å½•ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```http
POST /api/auth/phone-login
Content-Type: application/json

{
  "phoneNumber": "13800001001",
  "verificationCode": "123456"
}
```

## ğŸ¢ éƒ¨é—¨ç®¡ç†æ¥å£

### 1. è·å–éƒ¨é—¨åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/department/list`

**æ¥å£æè¿°**: è·å–æ‰€æœ‰éƒ¨é—¨åˆ—è¡¨ï¼ŒåŒ…å«éƒ¨é—¨ç®¡ç†å‘˜ä¿¡æ¯

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°**:
- `status` (å¯é€‰): éƒ¨é—¨çŠ¶æ€ï¼Œé»˜è®¤ `active`
- `includeManager` (å¯é€‰): æ˜¯å¦åŒ…å«ç®¡ç†å‘˜ä¿¡æ¯ï¼Œé»˜è®¤ `true`

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–éƒ¨é—¨åˆ—è¡¨æˆåŠŸ",
  "data": [
    {
      "_id": "ab217f4f-d436-4b0e-98bf-62db1d9620a2",
      "name": "åœ°è´¨æ•°æ®ä¸­å¿ƒ",
      "code": "GEO_DATA",
      "description": "è´Ÿè´£åœ°è´¨æ•°æ®çš„æ”¶é›†ã€æ•´ç†ã€åˆ†æå’Œåº”ç”¨",
      "level": 1,
      "status": "active",
      "createTime": "2025-09-01T16:33:23.000Z",
      "updateTime": "2025-09-01T16:34:07.000Z",
      "manager": {
        "_id": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
        "name": "åœ°è´¨æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜",
        "phone": "13800001001",
        "email": "zhangdata@example.com"
      }
    }
  ]
}
```

### 2. è·å–å½“å‰ç”¨æˆ·éƒ¨é—¨ä¿¡æ¯

**æ¥å£åœ°å€**: `GET /api/department/my`

**æ¥å£æè¿°**: è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„éƒ¨é—¨ä¿¡æ¯

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–éƒ¨é—¨ä¿¡æ¯æˆåŠŸ",
  "data": {
    "userId": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
    "departmentId": "ab217f4f-d436-4b0e-98bf-62db1d9620a2",
    "departmentName": "åœ°è´¨æ•°æ®ä¸­å¿ƒ",
    "departmentCode": "GEO_DATA",
    "departmentDescription": "è´Ÿè´£åœ°è´¨æ•°æ®çš„æ”¶é›†ã€æ•´ç†ã€åˆ†æå’Œåº”ç”¨",
    "role": "dept_admin",
    "isDepartmentAdmin": true
  }
}
```

### 3. è·å–éƒ¨é—¨è¯¦æƒ…

**æ¥å£åœ°å€**: `GET /api/department/{departmentId}`

**æ¥å£æè¿°**: è·å–æŒ‡å®šéƒ¨é—¨çš„è¯¦ç»†ä¿¡æ¯

**è·¯å¾„å‚æ•°**:
- `departmentId`: éƒ¨é—¨ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–éƒ¨é—¨è¯¦æƒ…æˆåŠŸ",
  "data": {
    "_id": "ab217f4f-d436-4b0e-98bf-62db1d9620a2",
    "name": "åœ°è´¨æ•°æ®ä¸­å¿ƒ",
    "code": "GEO_DATA",
    "description": "è´Ÿè´£åœ°è´¨æ•°æ®çš„æ”¶é›†ã€æ•´ç†ã€åˆ†æå’Œåº”ç”¨",
    "level": 1,
    "status": "active",
    "createTime": "2025-09-01T16:33:23.000Z",
    "updateTime": "2025-09-01T16:34:07.000Z",
    "memberCount": 15,
    "manager": {
      "_id": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
      "name": "åœ°è´¨æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜",
      "phone": "13800001001",
      "email": "zhangdata@example.com",
      "position": "éƒ¨é—¨ç®¡ç†å‘˜"
    }
  }
}
```

### 4. è·å–éƒ¨é—¨æˆå‘˜åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/department/{departmentId}/members`

**æ¥å£æè¿°**: è·å–æŒ‡å®šéƒ¨é—¨çš„æˆå‘˜åˆ—è¡¨ï¼ˆéƒ¨é—¨ç®¡ç†å‘˜åªèƒ½æŸ¥çœ‹æœ¬éƒ¨é—¨æˆå‘˜ï¼‰

**è·¯å¾„å‚æ•°**:
- `departmentId`: éƒ¨é—¨ID

**æŸ¥è¯¢å‚æ•°**:
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ 1
- `pageSize` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ 20
- `status` (å¯é€‰): ç”¨æˆ·çŠ¶æ€ï¼Œé»˜è®¤ `active`
- `role` (å¯é€‰): ç”¨æˆ·è§’è‰²
- `keyword` (å¯é€‰): æœç´¢å…³é”®è¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–éƒ¨é—¨æˆå‘˜æˆåŠŸ",
  "data": {
    "list": [
      {
        "_id": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
        "nickName": "åœ°è´¨æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜",
        "realName": null,
        "avatarUrl": null,
        "phoneNumber": "13800001001",
        "email": "zhangdata@example.com",
        "position": "éƒ¨é—¨ç®¡ç†å‘˜",
        "employeeId": "EMP001",
        "role": "dept_admin",
        "status": "active",
        "joinDate": null,
        "createTime": "2025-09-01T16:34:07.000Z",
        "lastLoginTime": "2025-09-02T00:43:36.000Z"
      }
    ],
    "total": 1,
    "page": 1,
    "pageSize": 20,
    "totalPages": 1
  }
}
```

### 5. è·å–éƒ¨é—¨ç®¡ç†å‘˜ä¸“ç”¨ä¿¡æ¯

**æ¥å£åœ°å€**: `GET /api/department/admin/my-info`

**æ¥å£æè¿°**: è·å–éƒ¨é—¨ç®¡ç†å‘˜çš„éƒ¨é—¨è¯¦ç»†ä¿¡æ¯ï¼ˆä»…éƒ¨é—¨ç®¡ç†å‘˜å¯è®¿é—®ï¼‰

**æƒé™è¦æ±‚**: éƒ¨é—¨ç®¡ç†å‘˜ (`dept_admin`)

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–éƒ¨é—¨ä¿¡æ¯æˆåŠŸ",
  "data": {
    "userId": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
    "departmentId": "ab217f4f-d436-4b0e-98bf-62db1d9620a2",
    "departmentName": "åœ°è´¨æ•°æ®ä¸­å¿ƒ",
    "departmentCode": "GEO_DATA",
    "departmentDescription": "è´Ÿè´£åœ°è´¨æ•°æ®çš„æ”¶é›†ã€æ•´ç†ã€åˆ†æå’Œåº”ç”¨",
    "role": "dept_admin",
    "isDepartmentAdmin": true,
    "memberCount": 15,
    "members": [
      {
        "_id": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
        "nickName": "åœ°è´¨æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜",
        "role": "éƒ¨é—¨ç®¡ç†å‘˜",
        "avatarUrl": null,
        "employeeId": "EMP001",
        "position": "éƒ¨é—¨ç®¡ç†å‘˜",
        "phoneNumber": "13800001001",
        "email": "zhangdata@example.com",
        "status": "active",
        "joinDate": null,
        "createTime": "2025-09-01T16:34:07.000Z",
        "lastLoginTime": "2025-09-02T00:43:36.000Z"
      }
    ]
  }
}
```

## ğŸ½ï¸ å¢å¼ºç‰ˆæŠ¥é¤æ¥å£

### 1. è·å–éƒ¨é—¨æˆå‘˜åˆ—è¡¨ï¼ˆæŠ¥é¤ç”¨ï¼‰

**æ¥å£åœ°å€**: `GET /api/dining/enhanced/dept-members`

**æ¥å£æè¿°**: è·å–å½“å‰ç”¨æˆ·æ‰€åœ¨éƒ¨é—¨çš„æˆå‘˜åˆ—è¡¨ï¼Œç”¨äºæŠ¥é¤é€‰æ‹©

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°**:
- `includeInactive` (å¯é€‰): æ˜¯å¦åŒ…å«éæ´»è·ƒç”¨æˆ·ï¼Œé»˜è®¤ `false`
- `keyword` (å¯é€‰): æœç´¢å…³é”®è¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–éƒ¨é—¨æˆå‘˜æˆåŠŸ",
  "data": [
    {
      "_id": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
      "name": "åœ°è´¨æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜",
      "realName": null,
      "role": "éƒ¨é—¨ç®¡ç†å‘˜",
      "avatarUrl": null,
      "employeeId": "EMP001",
      "position": "éƒ¨é—¨ç®¡ç†å‘˜",
      "phoneNumber": "13800001001",
      "email": "zhangdata@example.com",
      "status": "active",
      "isDepartmentAdmin": true
    }
  ]
}
```

### 2. éƒ¨é—¨æŠ¥é¤

**æ¥å£åœ°å€**: `POST /api/dining/enhanced/department-order`

**æ¥å£æè¿°**: éƒ¨é—¨ç®¡ç†å‘˜ä¸ºéƒ¨é—¨æˆå‘˜æŠ¥é¤

**æƒé™è¦æ±‚**: éƒ¨é—¨ç®¡ç†å‘˜ (`dept_admin`)

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**:
```json
{
  "date": "2025-09-02",
  "mealType": "lunch",
  "members": [
    {
      "userId": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0"
    },
    {
      "userId": "another-user-id"
    }
  ]
}
```

**å‚æ•°è¯´æ˜**:
- `date`: æŠ¥é¤æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DD
- `mealType`: é¤æ¬¡ç±»å‹ï¼Œå¯é€‰å€¼ï¼š`breakfast`ã€`lunch`ã€`dinner`
- `members`: æŠ¥é¤æˆå‘˜åˆ—è¡¨ï¼Œæ¯ä¸ªæˆå‘˜åŒ…å« `userId`

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "æˆåŠŸä¸º 2 åéƒ¨é—¨æˆå‘˜æŠ¥é¤",
  "data": {
    "success": true,
    "message": "æˆåŠŸä¸º 2 åéƒ¨é—¨æˆå‘˜æŠ¥é¤",
    "orders": [
      {
        "orderId": "order-uuid-1",
        "userId": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
        "userName": "åœ°è´¨æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜",
        "status": "confirmed"
      },
      {
        "orderId": "order-uuid-2",
        "userId": "another-user-id",
        "userName": "å¼ ä¸‰",
        "status": "confirmed"
      }
    ],
    "departmentName": "åœ°è´¨æ•°æ®ä¸­å¿ƒ"
  }
}
```

### 3. è·å–éƒ¨é—¨æŠ¥é¤è®°å½•

**æ¥å£åœ°å€**: `GET /api/dining/enhanced/department-orders`

**æ¥å£æè¿°**: è·å–éƒ¨é—¨æŠ¥é¤è®°å½•åˆ—è¡¨

**æƒé™è¦æ±‚**: éƒ¨é—¨ç®¡ç†å‘˜ (`dept_admin`)

**æŸ¥è¯¢å‚æ•°**:
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ 1
- `pageSize` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ 20
- `date` (å¯é€‰): æŒ‡å®šæ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DD
- `mealType` (å¯é€‰): é¤æ¬¡ç±»å‹
- `startDate` (å¯é€‰): å¼€å§‹æ—¥æœŸ
- `endDate` (å¯é€‰): ç»“æŸæ—¥æœŸ

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–éƒ¨é—¨æŠ¥é¤è®°å½•æˆåŠŸ",
  "data": {
    "list": [
      {
        "_id": "order-uuid-1",
        "userId": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
        "userName": "åœ°è´¨æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜",
        "realName": null,
        "employeeId": "EMP001",
        "position": "éƒ¨é—¨ç®¡ç†å‘˜",
        "publishDate": "2025-09-02",
        "mealType": "lunch",
        "menuName": "2025-09-02 åˆé¤èœå•",
        "orderTime": "2025-09-02T08:30:00.000Z",
        "status": "confirmed",
        "orderBy": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0"
      }
    ],
    "total": 1,
    "page": 1,
    "pageSize": 20,
    "totalPages": 1,
    "departmentName": "åœ°è´¨æ•°æ®ä¸­å¿ƒ"
  }
}
```

### 4. è·å–éƒ¨é—¨æŠ¥é¤ç»Ÿè®¡

**æ¥å£åœ°å€**: `GET /api/dining/enhanced/department-stats`

**æ¥å£æè¿°**: è·å–éƒ¨é—¨æŠ¥é¤ç»Ÿè®¡æ•°æ®

**æƒé™è¦æ±‚**: éƒ¨é—¨ç®¡ç†å‘˜ (`dept_admin`)

**æŸ¥è¯¢å‚æ•°**:
- `startDate` (å¯é€‰): å¼€å§‹æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DD
- `endDate` (å¯é€‰): ç»“æŸæ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DD

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–éƒ¨é—¨æŠ¥é¤ç»Ÿè®¡æˆåŠŸ",
  "data": {
    "departmentName": "åœ°è´¨æ•°æ®ä¸­å¿ƒ",
    "totalMembers": 15,
    "totalOrders": 45,
    "uniqueUsers": 12,
    "orderDays": 5,
    "mealTypeStats": {
      "breakfast": 15,
      "lunch": 20,
      "dinner": 10
    },
    "participationRate": 80
  }
}
```

### 5. è·å–éƒ¨é—¨æŠ¥é¤æ¦‚è§ˆ

**æ¥å£åœ°å€**: `GET /api/dining/enhanced/department-overview`

**æ¥å£æè¿°**: è·å–éƒ¨é—¨æŠ¥é¤æ¦‚è§ˆï¼ŒåŒ…å«ä»Šæ—¥æŠ¥é¤æƒ…å†µå’Œæˆå‘˜çŠ¶æ€

**æƒé™è¦æ±‚**: éƒ¨é—¨ç®¡ç†å‘˜ (`dept_admin`)

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–éƒ¨é—¨æŠ¥é¤æ¦‚è§ˆæˆåŠŸ",
  "data": {
    "date": "2025-09-02",
    "departmentName": "åœ°è´¨æ•°æ®ä¸­å¿ƒ",
    "totalMembers": 15,
    "todayStats": {
      "totalOrders": 8,
      "uniqueUsers": 8,
      "participationRate": 53,
      "mealTypeStats": {
        "breakfast": 3,
        "lunch": 5,
        "dinner": 0
      }
    },
    "members": [
      {
        "_id": "c8b1cbc0-49aa-432a-bfed-b7792db4e4d0",
        "name": "åœ°è´¨æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜",
        "realName": null,
        "role": "éƒ¨é—¨ç®¡ç†å‘˜",
        "avatarUrl": null,
        "employeeId": "EMP001",
        "position": "éƒ¨é—¨ç®¡ç†å‘˜",
        "phoneNumber": "13800001001",
        "email": "zhangdata@example.com",
        "status": "active",
        "isDepartmentAdmin": true,
        "hasOrdered": true,
        "orderInfo": {
          "mealType": "lunch",
          "orderTime": "2025-09-02T08:30:00.000Z",
          "status": "confirmed"
        }
      }
    ]
  }
}
```

## ğŸ”’ æƒé™è¯´æ˜

### è§’è‰²æƒé™ç­‰çº§

| è§’è‰² | æƒé™ç­‰çº§ | åŠŸèƒ½æè¿° |
|------|----------|----------|
| `user` | 1 | æ™®é€šç”¨æˆ·ï¼Œå¯è¿›è¡ŒæŠ¥é¤ã€é¢„çº¦ç­‰åŸºç¡€æ“ä½œ |
| `dept_admin` | 2 | éƒ¨é—¨ç®¡ç†å‘˜ï¼Œå¯ç®¡ç†æœ¬éƒ¨é—¨ç”¨æˆ·å’ŒæŸ¥çœ‹ç»Ÿè®¡æ•°æ® |
| `admin` | 3 | ç®¡ç†å‘˜ï¼Œå¯è¿›è¡Œç³»ç»Ÿç®¡ç†å’Œç”¨æˆ·ç®¡ç† |
| `sys_admin` | 4 | ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™ï¼ŒåŒ…æ‹¬è§’è‰²ç®¡ç† |
| `verifier` | 1 | éªŒè¯å‘˜ï¼Œä¸“é—¨ç”¨äºç”¨é¤éªŒè¯ç­‰æ“ä½œ |

### éƒ¨é—¨ç®¡ç†å‘˜æƒé™

éƒ¨é—¨ç®¡ç†å‘˜ (`dept_admin`) å…·æœ‰ä»¥ä¸‹æƒé™ï¼š

1. **éƒ¨é—¨ç®¡ç†æƒé™**ï¼š
   - æŸ¥çœ‹æœ¬éƒ¨é—¨ä¿¡æ¯
   - æŸ¥çœ‹æœ¬éƒ¨é—¨æˆå‘˜åˆ—è¡¨
   - è·å–æœ¬éƒ¨é—¨ç»Ÿè®¡æ•°æ®

2. **æŠ¥é¤ç®¡ç†æƒé™**ï¼š
   - ä¸ºæœ¬éƒ¨é—¨æˆå‘˜æŠ¥é¤
   - æŸ¥çœ‹æœ¬éƒ¨é—¨æŠ¥é¤è®°å½•
   - è·å–æœ¬éƒ¨é—¨æŠ¥é¤ç»Ÿè®¡
   - æŸ¥çœ‹æœ¬éƒ¨é—¨æŠ¥é¤æ¦‚è§ˆ

3. **æƒé™é™åˆ¶**ï¼š
   - åªèƒ½ç®¡ç†æœ¬éƒ¨é—¨ï¼Œæ— æ³•è·¨éƒ¨é—¨æ“ä½œ
   - æ— æ³•è®¿é—®å…¶ä»–éƒ¨é—¨çš„æˆå‘˜ä¿¡æ¯
   - æ— æ³•ä¸ºå…¶ä»–éƒ¨é—¨æˆå‘˜æŠ¥é¤

## ğŸ“Š éƒ¨é—¨ä¿¡æ¯

### æ”¯æŒçš„éƒ¨é—¨åˆ—è¡¨

| éƒ¨é—¨åç§° | éƒ¨é—¨ç¼–ç  | ç®¡ç†å‘˜æ‰‹æœºå· | æè¿° |
|----------|----------|--------------|------|
| åœ°è´¨æ•°æ®ä¸­å¿ƒ | GEO_DATA | 13800001001 | è´Ÿè´£åœ°è´¨æ•°æ®çš„æ”¶é›†ã€æ•´ç†ã€åˆ†æå’Œåº”ç”¨ |
| åœ°è´¨å·¥ç¨‹ä¸­å¿ƒ | GEO_ENG | 13800001002 | è´Ÿè´£åœ°è´¨å·¥ç¨‹é¡¹ç›®çš„è§„åˆ’ã€è®¾è®¡å’Œå®æ–½ |
| ç”Ÿæ€ç¯å¢ƒä¸­å¿ƒ | ECO_ENV | 13800001003 | è´Ÿè´£ç”Ÿæ€ç¯å¢ƒç›‘æµ‹ã€è¯„ä¼°å’Œä¿æŠ¤å·¥ä½œ |
| åœ°è´¨ç¯å¢ƒä¸­å¿ƒ | GEO_ENV | 13800001004 | è´Ÿè´£åœ°è´¨ç¯å¢ƒè°ƒæŸ¥ã€è¯„ä»·å’Œæ²»ç† |
| åœ°è´¨è°ƒæŸ¥ä¸­å¿ƒ | GEO_SURVEY | 13800001005 | è´Ÿè´£åœ°è´¨è°ƒæŸ¥ã€å‹˜æ¢å’Œèµ„æºè¯„ä»· |
| é»„æ¢…åˆ†ç«™ | HUANGMEI | 13800001006 | é»„æ¢…åœ°åŒºåˆ†ç«™ï¼Œè´Ÿè´£åŒºåŸŸåœ°è´¨å·¥ä½œ |
| çŸ¿ä¸šæœ‰é™è´£ä»»å…¬å¸ | MINING_CO | 13800001007 | è´Ÿè´£çŸ¿ä¸šå¼€å‘ã€ç”Ÿäº§å’Œç»è¥ç®¡ç† |
| ç‰©ä¸šä¸­å¿ƒ | PROPERTY | 13800001008 | è´Ÿè´£ç‰©ä¸šç®¡ç†ã€ç»´æŠ¤å’ŒæœåŠ¡å·¥ä½œ |
| æœºå…³ç§‘å®¤ | ADMIN | 13800001009 | è´Ÿè´£è¡Œæ”¿ç®¡ç†ã€äººäº‹è´¢åŠ¡ç­‰æœºå…³å·¥ä½œ |

## âš ï¸ é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯ç 

| é”™è¯¯ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|--------|------|----------|
| 401 | æœªæˆæƒ | æ£€æŸ¥Tokenæ˜¯å¦æœ‰æ•ˆï¼Œé‡æ–°ç™»å½• |
| 403 | æƒé™ä¸è¶³ | ç¡®è®¤ç”¨æˆ·è§’è‰²æ˜¯å¦æœ‰ç›¸åº”æƒé™ |
| 404 | èµ„æºä¸å­˜åœ¨ | æ£€æŸ¥è¯·æ±‚çš„èµ„æºIDæ˜¯å¦æ­£ç¡® |
| 422 | å‚æ•°éªŒè¯å¤±è´¥ | æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼å’Œå¿…å¡«é¡¹ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | è”ç³»æŠ€æœ¯æ”¯æŒ |

### é”™è¯¯å“åº”æ ¼å¼

```json
{
  "success": false,
  "message": "é”™è¯¯æè¿°",
  "code": "é”™è¯¯ç ",
  "error": "è¯¦ç»†é”™è¯¯ä¿¡æ¯",
  "timestamp": "2025-09-02T00:43:36.492Z"
}
```

## ğŸš€ å‰ç«¯é›†æˆç¤ºä¾‹

### 1. ç™»å½•è·å–Token

```javascript
// ç™»å½•è·å–Token
async function login(phoneNumber, password) {
  try {
    const response = await fetch('/api/auth/test-login-admin', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        phoneNumber,
        password
      })
    });
    
    const result = await response.json();
    
    if (result.success) {
      const token = result.data.token;
      localStorage.setItem('token', token);
      return result.data.userInfo;
    } else {
      throw new Error(result.message);
    }
  } catch (error) {
    console.error('ç™»å½•å¤±è´¥:', error);
    throw error;
  }
}
```

### 2. è·å–éƒ¨é—¨åˆ—è¡¨

```javascript
// è·å–éƒ¨é—¨åˆ—è¡¨
async function getDepartments() {
  try {
    const token = localStorage.getItem('token');
    const response = await fetch('/api/department/list', {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    
    const result = await response.json();
    
    if (result.success) {
      return result.data;
    } else {
      throw new Error(result.message);
    }
  } catch (error) {
    console.error('è·å–éƒ¨é—¨åˆ—è¡¨å¤±è´¥:', error);
    throw error;
  }
}
```

### 3. éƒ¨é—¨æŠ¥é¤

```javascript
// éƒ¨é—¨æŠ¥é¤
async function createDepartmentOrder(date, mealType, memberIds) {
  try {
    const token = localStorage.getItem('token');
    const response = await fetch('/api/dining/enhanced/department-order', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        date,
        mealType,
        members: memberIds.map(id => ({ userId: id }))
      })
    });
    
    const result = await response.json();
    
    if (result.success) {
      return result.data;
    } else {
      throw new Error(result.message);
    }
  } catch (error) {
    console.error('éƒ¨é—¨æŠ¥é¤å¤±è´¥:', error);
    throw error;
  }
}
```

### 4. è·å–éƒ¨é—¨æŠ¥é¤æ¦‚è§ˆ

```javascript
// è·å–éƒ¨é—¨æŠ¥é¤æ¦‚è§ˆ
async function getDepartmentOverview() {
  try {
    const token = localStorage.getItem('token');
    const response = await fetch('/api/dining/enhanced/department-overview', {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    
    const result = await response.json();
    
    if (result.success) {
      return result.data;
    } else {
      throw new Error(result.message);
    }
  } catch (error) {
    console.error('è·å–éƒ¨é—¨æŠ¥é¤æ¦‚è§ˆå¤±è´¥:', error);
    throw error;
  }
}
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **Tokenç®¡ç†**ï¼šTokenæœ‰æ•ˆæœŸä¸º7å¤©ï¼Œè¿‡æœŸåéœ€è¦é‡æ–°ç™»å½•
2. **æƒé™éªŒè¯**ï¼šæ‰€æœ‰æ¥å£éƒ½ä¼šéªŒè¯ç”¨æˆ·æƒé™ï¼Œç¡®ä¿æ•°æ®å®‰å…¨
3. **å‚æ•°éªŒè¯**ï¼šè¯·æ±‚å‚æ•°ä¼šè¿›è¡Œä¸¥æ ¼éªŒè¯ï¼Œè¯·ç¡®ä¿æ ¼å¼æ­£ç¡®
4. **é”™è¯¯å¤„ç†**ï¼šå»ºè®®å‰ç«¯å®ç°ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
5. **åˆ†é¡µæŸ¥è¯¢**ï¼šåˆ—è¡¨æ¥å£æ”¯æŒåˆ†é¡µï¼Œå»ºè®®åˆç†è®¾ç½®pageSize
6. **æ—¥æœŸæ ¼å¼**ï¼šæ‰€æœ‰æ—¥æœŸå‚æ•°ä½¿ç”¨YYYY-MM-DDæ ¼å¼
7. **æ—¶åŒºå¤„ç†**ï¼šæœåŠ¡å™¨ä½¿ç”¨UTC+8æ—¶åŒºï¼Œå‰ç«¯æ˜¾ç¤ºæ—¶è¯·æ³¨æ„æ—¶åŒºè½¬æ¢

## ğŸ”„ æ›´æ–°æ—¥å¿—

### v3.0 (2025-09-02)
- æ–°å¢éƒ¨é—¨ç®¡ç†åŠŸèƒ½
- æ–°å¢éƒ¨é—¨ç®¡ç†å‘˜æƒé™æ§åˆ¶
- æ–°å¢å¢å¼ºç‰ˆæŠ¥é¤åŠŸèƒ½
- æ”¯æŒ9ä¸ªéƒ¨é—¨çš„ç‹¬ç«‹ç®¡ç†
- å®Œå–„æƒé™éš”ç¦»æœºåˆ¶

---

**æŠ€æœ¯æ”¯æŒ**: å¦‚æœ‰é—®é¢˜è¯·è”ç³»å¼€å‘å›¢é˜Ÿ
**æ–‡æ¡£ç‰ˆæœ¬**: v3.0
**æœ€åæ›´æ–°**: 2025-09-02
