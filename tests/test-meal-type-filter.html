<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>餐次类型筛选功能测试</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .api-test {
            background: #f1f3f4;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .result-box {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .error-box {
            background: #ffeaea;
            border: 1px solid #f44336;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .dish-item {
            background: white;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
        }
        .meal-tag {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 5px;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.warning { background: #fff3cd; color: #856404; }
        .status.error { background: #f8d7da; color: #721c24; }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #5a6fd8; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🍽️ 餐次类型筛选功能测试</h1>
            <p>测试菜品管理中的餐次类型筛选是否正常工作</p>
        </div>

        <div class="test-section">
            <h3>📋 当前数据分析</h3>
            <div class="result-box">
                <h4>✅ 接口响应正常</h4>
                <p>API接口 <code>/api/admin/dishes</code> 正常返回数据</p>
                <p>返回了 6 道菜品，分页信息正确</p>
                <p>字段格式符合预期：使用 <code>meal_types</code> 字段</p>
            </div>
            
            <div class="error-box">
                <h4>⚠️ 发现的问题</h4>
                <p><strong>所有菜品的餐次类型都是相同的</strong>：<code>["breakfast", "lunch", "dinner"]</code></p>
                <p>这意味着所有菜品都适用于早中晚三餐，无法测试筛选功能的有效性</p>
            </div>
        </div>

        <div class="test-section">
            <h3>🔍 当前菜品数据</h3>
            <div id="dishList">
                <div class="dish-item">
                    <h4>小笼包 - ¥8.00</h4>
                    <p>经典上海小笼包，皮薄馅大</p>
                    <div>
                        <span class="meal-tag">早餐</span>
                        <span class="meal-tag">午餐</span>
                        <span class="meal-tag">晚餐</span>
                        <span class="status success">推荐</span>
                    </div>
                </div>
                
                <div class="dish-item">
                    <h4>宫保鸡丁 - ¥25.50</h4>
                    <p>经典川菜，麻辣鲜香</p>
                    <div>
                        <span class="meal-tag">早餐</span>
                        <span class="meal-tag">午餐</span>
                        <span class="meal-tag">晚餐</span>
                        <span class="status success">推荐</span>
                    </div>
                </div>
                
                <div class="dish-item">
                    <h4>红烧肉 - ¥28.00</h4>
                    <p>肥瘦相间的红烧肉，入口即化</p>
                    <div>
                        <span class="meal-tag">早餐</span>
                        <span class="meal-tag">午餐</span>
                        <span class="meal-tag">晚餐</span>
                    </div>
                </div>
                
                <div class="dish-item">
                    <h4>白粥 - ¥3.00</h4>
                    <p>清淡养胃的白粥</p>
                    <div>
                        <span class="meal-tag">早餐</span>
                        <span class="meal-tag">午餐</span>
                        <span class="meal-tag">晚餐</span>
                    </div>
                </div>
                
                <div class="dish-item">
                    <h4>蛋炒饭 - ¥12.00</h4>
                    <p>粒粒分明的蛋炒饭</p>
                    <div>
                        <span class="meal-tag">早餐</span>
                        <span class="meal-tag">午餐</span>
                        <span class="meal-tag">晚餐</span>
                        <span class="status success">推荐</span>
                    </div>
                </div>
                
                <div class="dish-item">
                    <h4>糖醋排骨 - ¥32.00</h4>
                    <p>酸甜可口的糖醋排骨</p>
                    <div>
                        <span class="meal-tag">早餐</span>
                        <span class="meal-tag">午餐</span>
                        <span class="meal-tag">晚餐</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>🧪 筛选功能测试</h3>
            <p>要测试餐次类型筛选功能，需要创建一些只适用于特定餐次的菜品：</p>
            
            <div class="api-test">
                <h4>建议的测试数据：</h4>
                <p><strong>早餐专用菜品</strong>：</p>
                <ul>
                    <li>豆浆 - meal_types: ["breakfast"]</li>
                    <li>油条 - meal_types: ["breakfast"]</li>
                    <li>煎蛋 - meal_types: ["breakfast"]</li>
                </ul>
                
                <p><strong>午餐专用菜品</strong>：</p>
                <ul>
                    <li>回锅肉 - meal_types: ["lunch"]</li>
                    <li>麻婆豆腐 - meal_types: ["lunch"]</li>
                </ul>
                
                <p><strong>晚餐专用菜品</strong>：</p>
                <ul>
                    <li>清汤面条 - meal_types: ["dinner"]</li>
                    <li>小炒肉 - meal_types: ["dinner"]</li>
                </ul>
                
                <p><strong>多餐次菜品</strong>：</p>
                <ul>
                    <li>白米饭 - meal_types: ["lunch", "dinner"]</li>
                    <li>青菜汤 - meal_types: ["breakfast", "lunch"]</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <h3>🔗 测试API调用</h3>
            <div>
                <button onclick="testBreakfast()">测试早餐筛选</button>
                <button onclick="testLunch()">测试午餐筛选</button>
                <button onclick="testDinner()">测试晚餐筛选</button>
                <button onclick="testAll()">测试全部</button>
            </div>
            
            <div id="testResults"></div>
        </div>

        <div class="test-section">
            <h3>✅ 解决方案</h3>
            <div class="result-box">
                <h4>1. 数据层面的解决方案</h4>
                <p>需要在后端创建一些具有不同餐次类型的测试菜品，例如：</p>
                <ul>
                    <li>将 "白粥" 设置为只适用早餐：meal_types: ["breakfast"]</li>
                    <li>将 "红烧肉" 设置为午餐和晚餐：meal_types: ["lunch", "dinner"]</li>
                    <li>创建一些专门的早餐菜品</li>
                </ul>
            </div>
            
            <div class="result-box">
                <h4>2. 前端功能验证</h4>
                <p>前端代码已经正确实现了：</p>
                <ul>
                    <li>✅ 餐次类型筛选器（下拉选择）</li>
                    <li>✅ 快速筛选按钮</li>
                    <li>✅ 餐次类型标签显示</li>
                    <li>✅ 筛选参数正确传递给后端</li>
                </ul>
            </div>
            
            <div class="result-box">
                <h4>3. 后端接口验证</h4>
                <p>后端接口工作正常：</p>
                <ul>
                    <li>✅ 正确返回菜品列表</li>
                    <li>✅ 分页功能正常</li>
                    <li>✅ meal_types 字段格式正确</li>
                    <li>✅ 接收 mealType 筛选参数</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        function testAPI(mealType, name) {
            const url = `http://localhost:3000/api/admin/dishes?page=1&pageSize=10&mealType=${mealType}`;
            
            document.getElementById('testResults').innerHTML += `
                <div class="api-test">
                    <h4>测试 ${name}</h4>
                    <p><strong>请求URL</strong>: <code>${url}</code></p>
                    <p>由于跨域限制，请在浏览器开发者工具中手动测试此URL</p>
                </div>
            `;
        }

        function testBreakfast() {
            testAPI('breakfast', '早餐筛选');
        }

        function testLunch() {
            testAPI('lunch', '午餐筛选');
        }

        function testDinner() {
            testAPI('dinner', '晚餐筛选');
        }

        function testAll() {
            testAPI('', '全部筛选');
        }
    </script>
</body>
</html>
