# 测试登录功能说明

## 功能概述

测试登录功能是为了方便开发者和测试人员快速进入系统，测试各个页面的功能而设计的。通过点击"测试登录"按钮，可以绕过正常的登录流程，直接使用测试账号进入系统。

**现在支持真正的页面跳转功能！测试登录成功后会自动跳转到首页，并可以通过tabBar在不同页面间切换。**

## 使用方法

### 1. 基本操作
1. 在登录页面找到"其他登录方式"区域
2. 点击"🧪 测试登录"按钮
3. 在弹出的确认对话框中点击"测试登录"
4. 系统将自动完成登录并跳转到首页

### 2. 测试账号信息
- **用户名**: 测试用户
- **角色**: 普通用户 (user)
- **部门**: 测试部门
- **手机号**: 13800138000
- **邮箱**: test@example.com
- **头像**: 默认头像

## 技术实现

### 1. 前端实现
- 在登录页面添加"测试登录"按钮
- 实现测试登录处理方法
- 支持云函数调用和本地备选方案
- 使用页面跳转API实现真正的页面切换
- 支持tabBar页面间的跳转

### 2. 后端实现
- 创建 `testLogin` 云函数
- 生成测试用户数据和token
- 支持数据库存储和查询

### 3. 数据流程
```
用户点击测试登录 → 调用云函数 → 生成测试数据 → 保存到本地 → 跳转到首页
```

### 4. 页面跳转功能
- 支持 `uni.switchTab` 跳转到tabBar页面
- 支持 `uni.navigateTo` 跳转到普通页面
- 支持 `uni.redirectTo` 重定向页面
- 支持 `uni.reLaunch` 重启应用

## 页面配置

### 1. pages.json 配置
```json
{
  "pages": [
    {
      "path": "pages/login/login",
      "style": {
        "navigationBarTitleText": "登录"
      }
    },
    {
      "path": "pages/index/index",
      "style": {
        "navigationBarTitleText": "智慧物业"
      }
    },
    {
      "path": "pages/dining/dining",
      "style": {
        "navigationBarTitleText": "日常报餐"
      }
    },
    {
      "path": "pages/reservation/reservation",
      "style": {
        "navigationBarTitleText": "球馆预约"
      }
    },
    {
      "path": "pages/profile/profile",
      "style": {
        "navigationBarTitleText": "个人中心"
      }
    },
    {
      "path": "pages/verification/verification",
      "style": {
        "navigationBarTitleText": "用餐验证"
      }
    }
  ],
  "tabBar": {
    "list": [
      {
        "pagePath": "pages/index/index",
        "text": "首页"
      },
      {
        "pagePath": "pages/dining/dining",
        "text": "报餐"
      },
      {
        "pagePath": "pages/reservation/reservation",
        "text": "预约"
      },
      {
        "pagePath": "pages/profile/profile",
        "text": "我的"
      }
    ]
  }
}
```

## 首页功能模块

### 1. 功能导航
- **日常报餐**: 跳转到报餐页面，包含今日菜单和部门报餐功能
- **特殊预约**: 跳转到特殊预约报餐页面，用于商务接待等特殊需求
- **球馆预约**: 跳转到球馆预约页面，用于场地时间预约
- **用餐验证**: 跳转到用餐验证页面，支持扫码、手动输入、NFC验证

### 2. 今日菜单预览
- **点击功能**: 整个今日菜单预览区域都可以点击
- **跳转目标**: 自动跳转到今日报餐页面的"今日菜单"分栏
- **显示内容**: 显示当日菜单预览，包含菜品名称和分类
- **查看更多**: 点击"查看更多"按钮同样跳转到今日报餐页面

### 3. 快捷操作
- **今日菜单**: 点击跳转到今日报餐页面
- **我的预约**: 点击跳转到预约页面
- **返回登录**: 重置页面状态，返回登录界面

## 页面跳转说明

### 1. TabBar页面跳转
```javascript
// 跳转到首页
uni.switchTab({ url: '/pages/index/index' })

// 跳转到日常报餐
uni.switchTab({ url: '/pages/dining/dining' })

// 跳转到球馆预约
uni.switchTab({ url: '/pages/reservation/reservation' })

// 跳转到个人中心
uni.switchTab({ url: '/pages/profile/profile' })
```

### 2. 普通页面跳转
```javascript
// 跳转到用餐验证
uni.navigateTo({ url: '/pages/verification/verification' })
```

## 今日菜单功能详解

### 1. 首页今日菜单预览
- **显示位置**: 首页中央区域，在功能导航下方
- **点击区域**: 整个预览区域都可以点击
- **跳转目标**: 今日报餐页面的"今日菜单"分栏
- **交互效果**: 点击时有缩放和阴影变化效果

### 2. 今日报餐页面菜单分栏
- **分栏位置**: 第一个分栏标签
- **功能特性**: 
  - 日期选择器（可前后切换日期）
  - 餐次选择器（早餐、午餐、晚餐）
  - 菜品分类展示（荤菜、素菜、汤品等）
  - 菜品详细信息（名称、描述、标签、营养信息）
- **数据来源**: 云函数获取当日菜单数据

### 3. 其他页面的今日菜单入口
- **特殊预约报餐页面**: 快捷操作中的"今日菜单"按钮
- **用餐验证页面**: 快捷操作中的"今日菜单"按钮
- **跳转方式**: 都使用 `uni.switchTab` 跳转到今日报餐页面

## 测试建议

### 1. 基本功能测试
1. 测试登录功能是否正常工作
2. 验证页面跳转是否成功
3. 检查tabBar导航是否正常

### 2. 今日菜单测试
1. 点击首页今日菜单预览区域
2. 验证是否跳转到今日报餐页面
3. 检查今日菜单分栏是否显示
4. 测试日期和餐次切换功能

### 3. 页面导航测试
1. 测试所有功能模块的跳转
2. 验证快捷操作按钮的功能
3. 检查页面间的返回和前进

## 注意事项

1. **页面跳转**: 所有页面跳转都使用标准的uni-app API
2. **数据加载**: 页面跳转后会自动加载对应数据
3. **状态保持**: 登录状态会在页面跳转间保持
4. **错误处理**: 跳转失败时会显示相应的错误提示

## 更新日志

### v1.0.0 (当前版本)
- ✅ 实现测试登录功能
- ✅ 支持页面跳转和tabBar导航
- ✅ 完善首页功能模块
- ✅ 修复今日菜单点击跳转问题
- ✅ 统一今日菜单跳转目标为今日报餐页面
- ✅ 添加今日菜单预览区域的点击效果
