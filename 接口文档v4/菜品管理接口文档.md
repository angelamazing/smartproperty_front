# èœå•ç®¡ç†å®Œæ•´æ¥å£è¯´æ˜

## ğŸ“‹ æ¥å£æ¦‚è¿°

èœå•ç®¡ç†æ¥å£æä¾›èœå•çš„åˆ›å»ºã€å‘å¸ƒã€æ’¤å›ã€æŸ¥è¯¢ç­‰åŠŸèƒ½ï¼Œæ”¯æŒæ—©ä¸­æ™šé¤çš„èœå•ç®¡ç†ï¼ŒåŒ…å«èœå“é€‰æ‹©ã€æ—¶é—´æ§åˆ¶ã€çŠ¶æ€ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

**åŸºç¡€è·¯å¾„**: `/api/admin/menu`

**è®¤è¯è¦æ±‚**: æ‰€æœ‰æ¥å£éƒ½éœ€è¦æœ‰æ•ˆçš„JWT Tokenå’Œç®¡ç†å‘˜æƒé™

**Content-Type**: `application/json`

## ğŸ” è®¤è¯è¯´æ˜

æ‰€æœ‰æ¥å£éƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ç®¡ç†å‘˜Tokenï¼š

```http
Authorization: Bearer {your_admin_token}
```

## â° æ—¶é—´å¤„ç†è¯´æ˜

èœå•ç®¡ç†éµå¾ªé¡¹ç›®ç»Ÿä¸€æ—¶é—´å¤„ç†è§„èŒƒï¼š
- **å­˜å‚¨æ ¼å¼**: UTCæ—¶é—´
- **APIä¼ è¾“**: ISO 8601æ ¼å¼
- **å‰ç«¯æ˜¾ç¤º**: åŒ—äº¬æ—¶é—´(UTC+8)
- **æ—¶é—´éªŒè¯**: é˜²æ­¢ä¿å­˜è¿‡å»æ—¥æœŸ

## ğŸ“š èœå•ç®¡ç†æ¥å£åˆ—è¡¨

### 1. ä¿å­˜èœå•è‰ç¨¿

**æ¥å£åœ°å€**: `POST /api/admin/menu/draft`

**æ¥å£æè¿°**: ä¿å­˜èœå•è‰ç¨¿ï¼Œæ”¯æŒåˆ›å»ºæ–°è‰ç¨¿æˆ–æ›´æ–°ç°æœ‰è‰ç¨¿

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**:
```json
{
  "date": "2025-12-01",                    // å¿…å¡«ï¼Œå‘å¸ƒæ—¥æœŸ (YYYY-MM-DD)
  "mealType": "lunch",                     // å¿…å¡«ï¼Œé¤æ¬¡ç±»å‹ï¼šbreakfast/lunch/dinner
  "dishes": [                              // å¿…å¡«ï¼Œèœå“åˆ—è¡¨
    {
      "dishId": "dish_id_1",               // èœå“ID
      "price": 15.0,                       // å¯é€‰ï¼Œä»·æ ¼ï¼Œé»˜è®¤ä½¿ç”¨èœå“åŸä»·
      "sort": 1                            // å¯é€‰ï¼Œæ’åºï¼Œé»˜è®¤ä¸ºæ•°ç»„ç´¢å¼•
    },
    {
      "dishId": "dish_id_2",
      "price": 12.0,
      "sort": 2
    }
  ],
  "description": "ä»Šæ—¥åˆé¤èœå•",            // å¯é€‰ï¼Œèœå•æè¿°
  "status": "draft"                        // å¯é€‰ï¼ŒçŠ¶æ€ï¼šdraft/publishedï¼Œé»˜è®¤draft
}
```

**å‚æ•°éªŒè¯**:
- `date`: ä¸èƒ½ä¸ºç©ºï¼Œä¸èƒ½æ˜¯è¿‡å»çš„æ—¥æœŸ
- `mealType`: å¿…é¡»æ˜¯ breakfast/lunch/dinner ä¹‹ä¸€
- `dishes`: å¿…é¡»æ˜¯æ•°ç»„ï¼Œä¸èƒ½ä¸ºç©º
- `dishes.*.dishId`: èœå“IDä¸èƒ½ä¸ºç©º

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå•è‰ç¨¿ä¿å­˜æˆåŠŸ",
  "data": {
    "id": "menu_id_123",
    "date": "2025-12-01",
    "mealType": "lunch",
    "status": "draft",
    "description": "ä»Šæ—¥åˆé¤èœå•",
    "dishes": [
      {
        "dishId": "dish_id_1",
        "price": 15.0,
        "sort": 1
      }
    ]
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 2. å‘å¸ƒèœå•

**æ¥å£åœ°å€**: `POST /api/admin/menu/publish`

**æ¥å£æè¿°**: å‘å¸ƒèœå•ï¼Œå°†è‰ç¨¿çŠ¶æ€è½¬ä¸ºå·²å‘å¸ƒçŠ¶æ€ï¼Œè‡ªåŠ¨è®¾ç½®å‘å¸ƒæ—¶é—´å’Œç”Ÿæ•ˆæ—¶é—´

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**:
```json
{
  "date": "2025-12-01",                    // å¿…å¡«ï¼Œå‘å¸ƒæ—¥æœŸ
  "mealType": "lunch",                     // å¿…å¡«ï¼Œé¤æ¬¡ç±»å‹
  "dishes": [                              // å¿…å¡«ï¼Œèœå“åˆ—è¡¨
    {
      "dishId": "dish_id_1",
      "price": 15.0,
      "sort": 1
    }
  ],
  "description": "ä»Šæ—¥åˆé¤èœå•",            // å¯é€‰ï¼Œèœå•æè¿°
  "publishTime": "2025-09-16T12:00:00.000Z", // å¯é€‰ï¼Œå‘å¸ƒæ—¶é—´ï¼Œé»˜è®¤å½“å‰æ—¶é—´
  "effectiveTime": "2025-12-01T11:00:00.000Z" // å¯é€‰ï¼Œç”Ÿæ•ˆæ—¶é—´ï¼Œé»˜è®¤å½“å‰æ—¶é—´
}
```

**å‚æ•°éªŒè¯**:
- `date`: ä¸èƒ½ä¸ºç©ºï¼Œä¸èƒ½æ˜¯è¿‡å»çš„æ—¥æœŸ
- `mealType`: å¿…é¡»æ˜¯ breakfast/lunch/dinner ä¹‹ä¸€
- `dishes`: å¿…é¡»æ˜¯æ•°ç»„ï¼Œä¸èƒ½ä¸ºç©º
- `publishTime`: å¯é€‰ï¼Œå¿…é¡»æ˜¯ISO 8601æ ¼å¼
- `effectiveTime`: å¯é€‰ï¼Œå¿…é¡»æ˜¯ISO 8601æ ¼å¼ï¼Œä¸èƒ½æ˜¯è¿‡å»æ—¶é—´

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå•å‘å¸ƒæˆåŠŸ",
  "data": {
    "id": "menu_id_123",
    "date": "2025-12-01",
    "mealType": "lunch",
    "status": "published",
    "description": "ä»Šæ—¥åˆé¤èœå•",
    "publishTime": "2025-09-16T12:50:17.000Z",
    "effectiveTime": "2025-09-16T12:50:17.000Z",
    "dishes": [
      {
        "dishId": "dish_id_1",
        "price": 15.0,
        "sort": 1
      }
    ]
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 3. è·å–èœå•å†å²

**æ¥å£åœ°å€**: `GET /api/admin/menu/history`

**æ¥å£æè¿°**: è·å–èœå•å‘å¸ƒå†å²è®°å½•ï¼Œæ”¯æŒåˆ†é¡µå’Œç­›é€‰

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| page | number | å¦ | 1 | é¡µç ï¼Œå¿…é¡»å¤§äº0 |
| pageSize | number | å¦ | 20 | æ¯é¡µæ•°é‡ï¼Œ1-100ä¹‹é—´ |
| startDate | string | å¦ | - | å¼€å§‹æ—¥æœŸ (YYYY-MM-DD) |
| endDate | string | å¦ | - | ç»“æŸæ—¥æœŸ (YYYY-MM-DD) |
| mealType | string | å¦ | - | é¤æ¬¡ç±»å‹ï¼šbreakfast/lunch/dinner |

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /api/admin/menu/history?page=1&pageSize=10&mealType=lunch&startDate=2025-09-01&endDate=2025-09-30
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–èœå•å†å²æˆåŠŸ",
  "data": {
    "list": [
      {
        "_id": "menu_id_123",
        "publishDate": "2025-09-15",
        "mealType": "lunch",
        "publishStatus": "published",
        "description": "ä»Šæ—¥åˆé¤èœå•",
        "publisherId": "admin_id_1",
        "publishTime": "2025-09-15T10:30:00.000Z",
        "effectiveTime": "2025-09-15T11:00:00.000Z",
        "createTime": "2025-09-15T10:00:00.000Z",
        "updateTime": "2025-09-15T10:30:00.000Z",
        "dishes": [
          {
            "dishId": "dish_id_1",
            "dishName": "å®«ä¿é¸¡ä¸",
            "price": 15.0,
            "sort": 1
          }
        ]
      }
    ],
    "pagination": {
      "page": 1,
      "pageSize": 10,
      "total": 25,
      "totalPages": 3
    }
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 4. æ ¹æ®æ—¥æœŸå’Œé¤æ¬¡è·å–èœå•

**æ¥å£åœ°å€**: `GET /api/admin/menu/by-date`

**æ¥å£æè¿°**: æ ¹æ®æŒ‡å®šæ—¥æœŸå’Œé¤æ¬¡è·å–èœå•ä¿¡æ¯

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| date | string | æ˜¯ | æ—¥æœŸ (YYYY-MM-DD) |
| mealType | string | æ˜¯ | é¤æ¬¡ç±»å‹ï¼šbreakfast/lunch/dinner |

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /api/admin/menu/by-date?date=2025-12-01&mealType=lunch
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–èœå•æˆåŠŸ",
  "data": {
    "_id": "menu_id_123",
    "publishDate": "2025-12-01",
    "mealType": "lunch",
    "publishStatus": "published",
    "description": "ä»Šæ—¥åˆé¤èœå•",
    "publisherId": "admin_id_1",
    "publishTime": "2025-09-16T12:50:17.000Z",
    "effectiveTime": "2025-09-16T12:50:17.000Z",
    "createTime": "2025-09-16T12:00:00.000Z",
    "updateTime": "2025-09-16T12:50:17.000Z",
    "dishes": [
      {
        "dishId": "dish_id_1",
        "dishName": "å®«ä¿é¸¡ä¸",
        "description": "ç»å…¸å·èœï¼Œå£æ„Ÿéº»è¾£é²œé¦™",
        "price": 15.0,
        "categoryName": "è¤èœ",
        "image": "https://example.com/dish1.jpg",
        "sort": 1
      }
    ]
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 5. æ’¤å›èœå•

**æ¥å£åœ°å€**: `PUT /api/admin/menu/:menuId/revoke`

**æ¥å£æè¿°**: æ’¤å›å·²å‘å¸ƒçš„èœå•ï¼Œå°†å…¶çŠ¶æ€æ”¹ä¸ºå·²æ’¤å›

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| menuId | string | æ˜¯ | èœå•ID |

**è¯·æ±‚ç¤ºä¾‹**:
```http
PUT /api/admin/menu/menu_id_123/revoke
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå•æ’¤å›æˆåŠŸ",
  "data": {
    "_id": "menu_id_123",
    "publishStatus": "revoked",
    "updateTime": "2025-09-16T12:50:17.000Z"
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 6. è·å–èœå•çš„èœå“åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/admin/menu/:menuId/dishes`

**æ¥å£æè¿°**: è·å–æŒ‡å®šèœå•çš„èœå“è¯¦ç»†ä¿¡æ¯

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| menuId | string | æ˜¯ | èœå•ID |

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /api/admin/menu/menu_id_123/dishes
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–èœå•èœå“æˆåŠŸ",
  "data": [
    {
      "_id": "menu_dish_id_1",
      "menuId": "menu_id_123",
      "dishId": "dish_id_1",
      "price": 15.0,
      "sort": 1,
      "dishName": "å®«ä¿é¸¡ä¸",
      "dishDescription": "ç»å…¸å·èœï¼Œå£æ„Ÿéº»è¾£é²œé¦™",
      "dishImage": "https://example.com/dish1.jpg",
      "categoryName": "è¤èœ",
      "createTime": "2025-09-16T12:00:00.000Z"
    }
  ],
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 7. è®¾ç½®èœå•èœå“

**æ¥å£åœ°å€**: `POST /api/admin/menu/:menuId/dishes`

**æ¥å£æè¿°**: ä¸ºæŒ‡å®šèœå•è®¾ç½®èœå“åˆ—è¡¨

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| menuId | string | æ˜¯ | èœå•ID |

**è¯·æ±‚å‚æ•°**:
```json
{
  "dishItems": [                           // å¿…å¡«ï¼Œèœå“é¡¹ç›®æ•°ç»„
    {
      "dishId": "dish_id_1",               // å¿…å¡«ï¼Œèœå“ID
      "price": 15.0,                       // å¯é€‰ï¼Œä»·æ ¼ï¼Œé»˜è®¤ä½¿ç”¨èœå“åŸä»·
      "sort": 1                            // å¯é€‰ï¼Œæ’åºï¼Œé»˜è®¤ä¸ºæ•°ç»„ç´¢å¼•
    },
    {
      "dishId": "dish_id_2",
      "price": 12.0,
      "sort": 2
    }
  ]
}
```

**å‚æ•°éªŒè¯**:
- `dishItems`: å¿…é¡»æ˜¯æ•°ç»„
- `dishItems.*.dishId`: èœå“IDä¸èƒ½ä¸ºç©º
- `dishItems.*.price`: å¯é€‰ï¼Œå¿…é¡»å¤§äºç­‰äº0
- `dishItems.*.sort`: å¯é€‰ï¼Œå¿…é¡»å¤§äºç­‰äº0

**è¯·æ±‚ç¤ºä¾‹**:
```http
POST /api/admin/menu/menu_id_123/dishes
Authorization: Bearer {token}
Content-Type: application/json

{
  "dishItems": [
    {
      "dishId": "dish_id_1",
      "price": 15.0,
      "sort": 1
    }
  ]
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå•èœå“è®¾ç½®æˆåŠŸ",
  "data": {
    "menuId": "menu_id_123",
    "dishCount": 1,
    "dishes": [
      {
        "dishId": "dish_id_1",
        "price": 15.0,
        "sort": 1
      }
    ]
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 8. è·å–èœå•æ¨¡æ¿

**æ¥å£åœ°å€**: `GET /api/admin/menu/templates`

**æ¥å£æè¿°**: è·å–èœå•æ¨¡æ¿åˆ—è¡¨

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /api/admin/menu/templates
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–èœå•æ¨¡æ¿æˆåŠŸ",
  "data": [
    {
      "_id": "template_id_1",
      "name": "å·¥ä½œæ—¥åˆé¤æ¨¡æ¿",
      "description": "é€‚åˆå·¥ä½œæ—¥åˆé¤çš„èœå“ç»„åˆ",
      "mealType": "lunch",
      "dishes": [
        {
          "dishId": "dish_id_1",
          "price": 15.0,
          "sort": 1
        }
      ],
      "createTime": "2025-09-01T10:00:00.000Z",
      "updateTime": "2025-09-01T10:00:00.000Z"
    }
  ],
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 9. åˆ é™¤èœå•æ¨¡æ¿

**æ¥å£åœ°å€**: `DELETE /api/admin/menu/templates/:templateId`

**æ¥å£æè¿°**: åˆ é™¤æŒ‡å®šçš„èœå•æ¨¡æ¿

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| templateId | string | æ˜¯ | æ¨¡æ¿ID |

**è¯·æ±‚ç¤ºä¾‹**:
```http
DELETE /api/admin/menu/templates/template_id_1
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå•æ¨¡æ¿åˆ é™¤æˆåŠŸ",
  "data": {
    "templateId": "template_id_1"
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

## ğŸ“Š èœå“ç®¡ç†æ¥å£åˆ—è¡¨

### 10. è·å–èœå“åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/admin/dishes`

**æ¥å£æè¿°**: è·å–èœå“åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œç­›é€‰

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| page | number | å¦ | 1 | é¡µç ï¼Œå¿…é¡»å¤§äº0 |
| pageSize | number | å¦ | 20 | æ¯é¡µæ•°é‡ï¼Œ1-100ä¹‹é—´ |
| keyword | string | å¦ | - | å…³é”®è¯æœç´¢ï¼ˆèœå“åç§°/æè¿°ï¼‰ |
| categoryId | string | å¦ | - | åˆ†ç±»IDç­›é€‰ |
| status | string | å¦ | - | çŠ¶æ€ç­›é€‰ï¼šactive/inactive |
| mealType | string | å¦ | - | é¤æ¬¡ç±»å‹ç­›é€‰ï¼šbreakfast/lunch/dinner |

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /api/admin/dishes?page=1&pageSize=10&mealType=lunch&keyword=é¸¡ä¸
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–èœå“åˆ—è¡¨æˆåŠŸ",
  "data": {
    "list": [
      {
        "_id": "dish_id_1",
        "name": "å®«ä¿é¸¡ä¸",
        "description": "ç»å…¸å·èœï¼Œå£æ„Ÿéº»è¾£é²œé¦™",
        "price": 15.0,
        "categoryId": "cat_id_1",
        "categoryName": "è¤èœ",
        "image": "https://example.com/dish1.jpg",
        "calories": 280,
        "protein": 25.5,
        "fat": 12.3,
        "carbohydrate": 18.7,
        "tags": ["å·èœ", "è¾£", "é¸¡è‚‰"],
        "meal_types": ["lunch", "dinner"],
        "status": "active",
        "isRecommended": true,
        "createTime": "2025-09-01T10:00:00.000Z",
        "updateTime": "2025-09-15T15:30:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "pageSize": 10,
      "total": 45,
      "totalPages": 5
    }
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 11. è·å–èœå“è¯¦æƒ…

**æ¥å£åœ°å€**: `GET /api/admin/dishes/:dishId`

**æ¥å£æè¿°**: è·å–æŒ‡å®šèœå“çš„è¯¦ç»†ä¿¡æ¯

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| dishId | string | æ˜¯ | èœå“ID |

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /api/admin/dishes/dish_id_1
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–èœå“è¯¦æƒ…æˆåŠŸ",
  "data": {
    "_id": "dish_id_1",
    "name": "å®«ä¿é¸¡ä¸",
    "description": "ç»å…¸å·èœï¼Œå£æ„Ÿéº»è¾£é²œé¦™ï¼Œé€‰ç”¨é¸¡èƒ¸è‚‰é…ä»¥èŠ±ç”Ÿç±³å’Œå¹²è¾£æ¤’åˆ¶ä½œè€Œæˆ",
    "price": 15.0,
    "categoryId": "cat_id_1",
    "categoryName": "è¤èœ",
    "image": "https://example.com/dish1.jpg",
    "calories": 280,
    "protein": 25.5,
    "fat": 12.3,
    "carbohydrate": 18.7,
    "tags": ["å·èœ", "è¾£", "é¸¡è‚‰", "èŠ±ç”Ÿ"],
    "meal_types": ["lunch", "dinner"],
    "status": "active",
    "isRecommended": true,
    "createTime": "2025-09-01T10:00:00.000Z",
    "updateTime": "2025-09-15T15:30:00.000Z",
    "createByName": "ç®¡ç†å‘˜"
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 12. åˆ›å»ºèœå“

**æ¥å£åœ°å€**: `POST /api/admin/dishes`

**æ¥å£æè¿°**: åˆ›å»ºæ–°èœå“

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**:
```json
{
  "name": "å®«ä¿é¸¡ä¸",                       // å¿…å¡«ï¼Œèœå“åç§°
  "description": "ç»å…¸å·èœï¼Œå£æ„Ÿéº»è¾£é²œé¦™",    // å¯é€‰ï¼Œèœå“æè¿°
  "price": 15.0,                          // å¿…å¡«ï¼Œä»·æ ¼
  "categoryId": "cat_id_1",               // å¿…å¡«ï¼Œåˆ†ç±»ID
  "image": "https://example.com/dish1.jpg", // å¯é€‰ï¼Œå›¾ç‰‡URL
  "calories": 280,                        // å¯é€‰ï¼Œå¡è·¯é‡Œ
  "protein": 25.5,                        // å¯é€‰ï¼Œè›‹ç™½è´¨(g)
  "fat": 12.3,                           // å¯é€‰ï¼Œè„‚è‚ª(g)
  "carbohydrate": 18.7,                   // å¯é€‰ï¼Œç¢³æ°´åŒ–åˆç‰©(g)
  "tags": ["å·èœ", "è¾£", "é¸¡è‚‰"],          // å¯é€‰ï¼Œæ ‡ç­¾æ•°ç»„
  "mealTypes": ["lunch", "dinner"],       // å¯é€‰ï¼Œé€‚ç”¨é¤æ¬¡
  "status": "active",                     // å¯é€‰ï¼ŒçŠ¶æ€ï¼šactive/inactiveï¼Œé»˜è®¤active
  "isRecommended": true                   // å¯é€‰ï¼Œæ˜¯å¦æ¨èï¼Œé»˜è®¤false
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå“åˆ›å»ºæˆåŠŸ",
  "data": {
    "_id": "dish_id_new"
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 13. æ›´æ–°èœå“

**æ¥å£åœ°å€**: `PUT /api/admin/dishes/:dishId`

**æ¥å£æè¿°**: æ›´æ–°èœå“ä¿¡æ¯

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| dishId | string | æ˜¯ | èœå“ID |

**è¯·æ±‚å‚æ•°**: ä¸åˆ›å»ºèœå“ç›¸åŒï¼Œæ‰€æœ‰å­—æ®µéƒ½æ˜¯å¯é€‰çš„

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå“æ›´æ–°æˆåŠŸ",
  "data": {
    "_id": "dish_id_1"
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 14. åˆ é™¤èœå“

**æ¥å£åœ°å€**: `DELETE /api/admin/dishes/:dishId`

**æ¥å£æè¿°**: åˆ é™¤èœå“ï¼ˆè½¯åˆ é™¤ï¼ŒçŠ¶æ€æ”¹ä¸ºdeletedï¼‰

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| dishId | string | æ˜¯ | èœå“ID |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå“åˆ é™¤æˆåŠŸ",
  "data": {
    "_id": "dish_id_1"
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 15. æ‰¹é‡æ›´æ–°èœå“çŠ¶æ€

**æ¥å£åœ°å€**: `PUT /api/admin/dishes/batch/status`

**æ¥å£æè¿°**: æ‰¹é‡æ›´æ–°èœå“çŠ¶æ€

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**:
```json
{
  "dishIds": ["dish_id_1", "dish_id_2"],  // å¿…å¡«ï¼Œèœå“IDæ•°ç»„
  "status": "active"                      // å¿…å¡«ï¼Œæ–°çŠ¶æ€ï¼šactive/inactive
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "æ‰¹é‡æ›´æ–°èœå“çŠ¶æ€æˆåŠŸ",
  "data": {
    "updatedCount": 2
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 16. è·å–èœå“åˆ†ç±»

**æ¥å£åœ°å€**: `GET /api/admin/dishes/categories`

**æ¥å£æè¿°**: è·å–èœå“åˆ†ç±»åˆ—è¡¨

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–èœå“åˆ†ç±»æˆåŠŸ",
  "data": [
    {
      "_id": "cat_id_1",
      "name": "è¤èœ",
      "description": "å„ç§è‚‰ç±»èœå“",
      "icon": "meat",
      "sort": 1,
      "status": "active",
      "createTime": "2025-09-01T10:00:00.000Z",
      "updateTime": "2025-09-01T10:00:00.000Z"
    },
    {
      "_id": "cat_id_2",
      "name": "ç´ èœ",
      "description": "å„ç§è”¬èœèœå“",
      "icon": "vegetable",
      "sort": 2,
      "status": "active",
      "createTime": "2025-09-01T10:00:00.000Z",
      "updateTime": "2025-09-01T10:00:00.000Z"
    }
  ],
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 17. åˆ›å»ºèœå“åˆ†ç±»

**æ¥å£åœ°å€**: `POST /api/admin/dishes/categories`

**æ¥å£æè¿°**: åˆ›å»ºèœå“åˆ†ç±»

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**:
```json
{
  "name": "æ±¤ç±»",                          // å¿…å¡«ï¼Œåˆ†ç±»åç§°
  "description": "å„ç§æ±¤ç±»èœå“",            // å¯é€‰ï¼Œåˆ†ç±»æè¿°
  "icon": "soup",                         // å¯é€‰ï¼Œå›¾æ ‡
  "sort": 3                              // å¯é€‰ï¼Œæ’åºï¼Œé»˜è®¤0
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå“åˆ†ç±»åˆ›å»ºæˆåŠŸ",
  "data": {
    "_id": "cat_id_new"
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

---

### 18. æ›´æ–°èœå“åˆ†ç±»

**æ¥å£åœ°å€**: `PUT /api/admin/dishes/categories/:categoryId`

**æ¥å£æè¿°**: æ›´æ–°èœå“åˆ†ç±»

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer {token}
Content-Type: application/json
```

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| categoryId | string | æ˜¯ | åˆ†ç±»ID |

**è¯·æ±‚å‚æ•°**: ä¸åˆ›å»ºåˆ†ç±»ç›¸åŒï¼Œæ‰€æœ‰å­—æ®µéƒ½æ˜¯å¯é€‰çš„

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "èœå“åˆ†ç±»æ›´æ–°æˆåŠŸ",
  "data": {
    "_id": "cat_id_1"
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

## âŒ é”™è¯¯å“åº”æ ¼å¼

æ‰€æœ‰æ¥å£åœ¨å‡ºé”™æ—¶éƒ½ä¼šè¿”å›ç»Ÿä¸€çš„é”™è¯¯æ ¼å¼ï¼š

```json
{
  "success": false,
  "message": "é”™è¯¯æè¿°ä¿¡æ¯",
  "error": {
    "code": "ERROR_CODE",
    "details": "è¯¦ç»†é”™è¯¯ä¿¡æ¯"
  },
  "timestamp": "2025-09-16T12:50:17.000Z"
}
```

## ğŸ“‹ å¸¸è§é”™è¯¯ç 

| é”™è¯¯ç  | HTTPçŠ¶æ€ç  | è¯´æ˜ |
|--------|------------|------|
| VALIDATION_ERROR | 400 | å‚æ•°éªŒè¯å¤±è´¥ |
| UNAUTHORIZED | 401 | æœªæˆæƒè®¿é—® |
| FORBIDDEN | 403 | æƒé™ä¸è¶³ |
| NOT_FOUND | 404 | èµ„æºä¸å­˜åœ¨ |
| DUPLICATE_MENU | 409 | èœå•å·²å­˜åœ¨ |
| PAST_DATE | 400 | ä¸èƒ½ä½¿ç”¨è¿‡å»æ—¥æœŸ |
| INTERNAL_ERROR | 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

## ğŸ§ª æµ‹è¯•è„šæœ¬

é¡¹ç›®æä¾›äº†å®Œæ•´çš„æµ‹è¯•è„šæœ¬æ¥éªŒè¯æ¥å£åŠŸèƒ½ï¼š

```bash
# æµ‹è¯•èœå•æ—¶é—´å¤„ç†ä¿®å¤
node scripts/test-menu-time-fix.js

# æµ‹è¯•èœå•å‘å¸ƒæµç¨‹
node scripts/test-menu-publish-flow.js

# æ£€æŸ¥æ•°æ®åº“è¡¨ç»“æ„
node scripts/check-menus-table.js
```

## ğŸ“ ä½¿ç”¨æ³¨æ„äº‹é¡¹

1. **æ—¶é—´å¤„ç†**: æ‰€æœ‰æ—¶é—´ç›¸å…³æ“ä½œéƒ½ä½¿ç”¨UTCæ—¶é—´å­˜å‚¨ï¼ŒAPIè¿”å›ISO 8601æ ¼å¼
2. **æƒé™æ§åˆ¶**: æ‰€æœ‰æ¥å£éƒ½éœ€è¦ç®¡ç†å‘˜æƒé™
3. **æ•°æ®éªŒè¯**: ä¸¥æ ¼éªŒè¯è¾“å…¥å‚æ•°ï¼Œé˜²æ­¢æ— æ•ˆæ•°æ®
4. **äº‹åŠ¡å¤„ç†**: èœå•å‘å¸ƒå’Œèœå“è®¾ç½®ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
5. **è½¯åˆ é™¤**: èœå“åˆ é™¤é‡‡ç”¨è½¯åˆ é™¤æ–¹å¼ï¼Œä¿ç•™æ•°æ®è®°å½•
6. **åˆ†é¡µæŸ¥è¯¢**: åˆ—è¡¨æ¥å£éƒ½æ”¯æŒåˆ†é¡µï¼Œé¿å…å¤§é‡æ•°æ®å½±å“æ€§èƒ½

## ğŸ”„ å·¥ä½œæµç¨‹ç¤ºä¾‹

### å…¸å‹çš„èœå•å‘å¸ƒæµç¨‹ï¼š

1. **è·å–å¯ç”¨èœå“** â†’ `GET /api/admin/dishes`
2. **ä¿å­˜èœå•è‰ç¨¿** â†’ `POST /api/admin/menu/draft`
3. **é¢„è§ˆèœå•å†…å®¹** â†’ `GET /api/admin/menu/:menuId/dishes`
4. **å‘å¸ƒèœå•** â†’ `POST /api/admin/menu/publish`
5. **æŸ¥çœ‹å‘å¸ƒå†å²** â†’ `GET /api/admin/menu/history`

è¿™ä¸ªå®Œæ•´çš„æ¥å£è¯´æ˜æ¶µç›–äº†èœå•ç®¡ç†çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬èœå•çš„åˆ›å»ºã€å‘å¸ƒã€ç®¡ç†ä»¥åŠç›¸å…³èœå“çš„ç®¡ç†åŠŸèƒ½ã€‚
