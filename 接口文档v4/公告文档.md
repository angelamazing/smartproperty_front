# å…¬å‘Šæ—¶é—´æ®µåŠŸèƒ½å¯¹æ¥æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£ä¸“é—¨ä¸ºå‰ç«¯å¼€å‘äººå‘˜æä¾›å…¬å‘Šæ—¶é—´æ®µåŠŸèƒ½çš„å¯¹æ¥è¯´æ˜ã€‚è¯¥åŠŸèƒ½æ”¯æŒè®¾ç½®å…¬å‘Šçš„ç”Ÿæ•ˆæ—¶é—´æ®µï¼Œ**åªéœ€è¦å¡«å†™æ—¥æœŸï¼Œä¸éœ€è¦ç²¾ç¡®åˆ°æ—¶åˆ†ç§’**ã€‚

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-01-27  
**é€‚ç”¨èŒƒå›´**: å‰ç«¯å¼€å‘äººå‘˜

---

## ğŸ¯ åŠŸèƒ½è¯´æ˜

### æ—¶é—´æ®µå…¬å‘Šç‰¹æ€§
- âœ… **ç®€åŒ–æ—¶é—´è¾“å…¥**ï¼šåªéœ€å¡«å†™æ—¥æœŸï¼Œç³»ç»Ÿè‡ªåŠ¨å¤„ç†æ—¶é—´
- âœ… **çµæ´»é…ç½®**ï¼šæ”¯æŒæ°¸ä¹…å…¬å‘Šå’Œä¸´æ—¶å…¬å‘Š
- âœ… **è‡ªåŠ¨ç”Ÿæ•ˆ**ï¼šç³»ç»Ÿæ ¹æ®æ—¶é—´æ®µè‡ªåŠ¨æ§åˆ¶å…¬å‘Šæ˜¾ç¤ºçŠ¶æ€
- âœ… **ç”¨æˆ·å‹å¥½**ï¼šå‰ç«¯åªéœ€æä¾›æ—¥æœŸé€‰æ‹©å™¨ï¼Œæ— éœ€å¤æ‚çš„æ—¶é—´é€‰æ‹©

### æ—¶é—´å¤„ç†è§„åˆ™
- **å¼€å§‹æ—¶é—´**ï¼šå¦‚æœåªå¡«å†™æ—¥æœŸï¼Œç³»ç»Ÿè‡ªåŠ¨è®¾ç½®ä¸º `00:00:00`
- **ç»“æŸæ—¶é—´**ï¼šå¦‚æœåªå¡«å†™æ—¥æœŸï¼Œç³»ç»Ÿè‡ªåŠ¨è®¾ç½®ä¸º `23:59:59`
- **æ°¸ä¹…å…¬å‘Š**ï¼šä¸å¡«å†™æ—¶é—´å­—æ®µï¼Œå…¬å‘Šæ°¸ä¹…æœ‰æ•ˆ

---

## ğŸ”Œ APIæ¥å£å¯¹æ¥

### 1. åˆ›å»ºæ—¶é—´æ®µå…¬å‘Š

**æ¥å£åœ°å€**: `POST /api/admin/notices`

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer <your-jwt-token>
Content-Type: application/json
```

**è¯·æ±‚ä½“å‚æ•°**:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| title | string | æ˜¯ | å…¬å‘Šæ ‡é¢˜ï¼ˆæœ€å¤§200å­—ç¬¦ï¼‰ | "ç³»ç»Ÿç»´æŠ¤é€šçŸ¥" |
| content | string | æ˜¯ | å…¬å‘Šå†…å®¹ | "ç³»ç»Ÿå°†äºæŒ‡å®šæ—¶é—´è¿›è¡Œç»´æŠ¤..." |
| type | string | å¦ | å…¬å‘Šç±»å‹ | "info", "warning", "error", "success" |
| priority | number | å¦ | ä¼˜å…ˆçº§ï¼ˆ0-10ï¼‰ | 5 |
| status | string | å¦ | çŠ¶æ€ | "draft", "published", "archived" |
| **startDate** | string | å¦ | **å¼€å§‹æ—¥æœŸï¼ˆYYYY-MM-DDæ ¼å¼ï¼‰** | "2025-01-27" |
| **endDate** | string | å¦ | **ç»“æŸæ—¥æœŸï¼ˆYYYY-MM-DDæ ¼å¼ï¼‰** | "2025-01-31" |
| isSticky | boolean | å¦ | æ˜¯å¦ç½®é¡¶ | true |
| targetUsers | array | å¦ | ç›®æ ‡ç”¨æˆ·IDæ•°ç»„ | ["user1", "user2"] |

**é‡è¦è¯´æ˜**ï¼š
- `startDate` å’Œ `endDate` ä¸º**å¯é€‰å­—æ®µ**
- å¦‚æœåªå¡«å†™ `startDate`ï¼Œç»“æŸæ—¶é—´é»˜è®¤ä¸ºå½“å¤© 23:59:59
- å¦‚æœåªå¡«å†™ `endDate`ï¼Œå¼€å§‹æ—¶é—´é»˜è®¤ä¸ºå½“å¤© 00:00:00
- å¦‚æœéƒ½ä¸å¡«å†™ï¼Œåˆ›å»ºæ°¸ä¹…å…¬å‘Š

**è¯·æ±‚ç¤ºä¾‹**:

#### ç¤ºä¾‹1ï¼šåˆ›å»ºä¸´æ—¶å…¬å‘Šï¼ˆæ¨èï¼‰
```json
{
  "title": "æ˜¥èŠ‚æ”¾å‡é€šçŸ¥",
  "content": "æ ¹æ®å›½å®¶æ³•å®šèŠ‚å‡æ—¥å®‰æ’ï¼Œç³»ç»Ÿå°†äºæ˜¥èŠ‚æœŸé—´æš‚åœæœåŠ¡...",
  "type": "info",
  "priority": 3,
  "status": "draft",
  "startDate": "2025-02-10",
  "endDate": "2025-02-17",
  "isSticky": true
}
```

#### ç¤ºä¾‹2ï¼šåˆ›å»ºæ°¸ä¹…å…¬å‘Š
```json
{
  "title": "ç³»ç»Ÿä½¿ç”¨è¯´æ˜",
  "content": "æ¬¢è¿ä½¿ç”¨æ™ºæ…§ç‰©ä¸šç®¡ç†ç³»ç»Ÿï¼Œè¯·ä»”ç»†é˜…è¯»ä»¥ä¸‹ä½¿ç”¨è¯´æ˜...",
  "type": "info",
  "priority": 1,
  "status": "published",
  "isSticky": false
}
```

#### ç¤ºä¾‹3ï¼šåˆ›å»ºå•æ—¥å…¬å‘Š
```json
{
  "title": "ç³»ç»Ÿå‡çº§é€šçŸ¥",
  "content": "ç³»ç»Ÿå°†äºæ˜å¤©è¿›è¡Œå‡çº§ç»´æŠ¤...",
  "type": "warning",
  "priority": 5,
  "startDate": "2025-01-28",
  "endDate": "2025-01-28"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "å…¬å‘Šåˆ›å»ºæˆåŠŸ",
  "data": {
    "_id": "notice-002",
    "title": "æ˜¥èŠ‚æ”¾å‡é€šçŸ¥",
    "content": "æ ¹æ®å›½å®¶æ³•å®šèŠ‚å‡æ—¥å®‰æ’ï¼Œç³»ç»Ÿå°†äºæ˜¥èŠ‚æœŸé—´æš‚åœæœåŠ¡...",
    "type": "info",
    "priority": 3,
    "status": "draft",
    "startTime": "2025-02-10T00:00:00.000Z",
    "endTime": "2025-02-17T23:59:59.000Z",
    "isSticky": true,
    "publisherId": "admin-001",
    "publisherName": "ç³»ç»Ÿç®¡ç†å‘˜",
    "publishTime": null,
    "createTime": "2025-01-27T03:00:00.000Z",
    "updateTime": "2025-01-27T03:00:00.000Z"
  }
}
```

---

### 2. æ›´æ–°å…¬å‘Šæ—¶é—´æ®µ

**æ¥å£åœ°å€**: `PUT /api/admin/notices/:noticeId`

**è¯·æ±‚ä½“å‚æ•°**ï¼ˆæ‰€æœ‰å­—æ®µéƒ½æ˜¯å¯é€‰çš„ï¼‰:

| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| title | string | å¦ | å…¬å‘Šæ ‡é¢˜ |
| content | string | å¦ | å…¬å‘Šå†…å®¹ |
| **startDate** | string | å¦ | **å¼€å§‹æ—¥æœŸï¼ˆYYYY-MM-DDæ ¼å¼ï¼‰** |
| **endDate** | string | å¦ | **ç»“æŸæ—¥æœŸï¼ˆYYYY-MM-DDæ ¼å¼ï¼‰** |
| type | string | å¦ | å…¬å‘Šç±»å‹ |
| priority | number | å¦ | ä¼˜å…ˆçº§ |
| status | string | å¦ | çŠ¶æ€ |
| isSticky | boolean | å¦ | æ˜¯å¦ç½®é¡¶ |

**è¯·æ±‚ç¤ºä¾‹**:
```json
{
  "title": "æ˜¥èŠ‚æ”¾å‡é€šçŸ¥ï¼ˆæ›´æ–°ï¼‰",
  "startDate": "2025-02-11",
  "endDate": "2025-02-18",
  "priority": 5
}
```

---

### 3. è·å–å…¬å‘Šåˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/admin/notices`

**æŸ¥è¯¢å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| page | number | å¦ | é¡µç ï¼ˆé»˜è®¤1ï¼‰ |
| pageSize | number | å¦ | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤20ï¼‰ |
| status | string | å¦ | çŠ¶æ€ç­›é€‰ |
| type | string | å¦ | ç±»å‹ç­›é€‰ |
| keyword | string | å¦ | å…³é”®è¯æœç´¢ |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "è·å–å…¬å‘Šåˆ—è¡¨æˆåŠŸ",
  "data": {
    "records": [
      {
        "_id": "notice-001",
        "title": "æ˜¥èŠ‚æ”¾å‡é€šçŸ¥",
        "content": "æ ¹æ®å›½å®¶æ³•å®šèŠ‚å‡æ—¥å®‰æ’...",
        "type": "info",
        "priority": 3,
        "status": "published",
        "startTime": "2025-02-10T00:00:00.000Z",
        "endTime": "2025-02-17T23:59:59.000Z",
        "isSticky": true,
        "viewCount": 0,
        "publisherId": "admin-001",
        "publisherName": "ç³»ç»Ÿç®¡ç†å‘˜",
        "publishTime": "2025-01-27T02:51:39.000Z",
        "createTime": "2025-01-27T02:51:39.000Z",
        "updateTime": "2025-01-27T02:51:39.000Z"
      }
    ],
    "total": 15,
    "page": 1,
    "pageSize": 20,
    "hasMore": true,
    "totalPages": 1
  }
}
```

---

## ğŸ¨ å‰ç«¯å®ç°å»ºè®®

### 1. è¡¨å•è®¾è®¡

#### å…¬å‘Šåˆ›å»º/ç¼–è¾‘è¡¨å•
```html
<form id="noticeForm">
  <!-- åŸºæœ¬ä¿¡æ¯ -->
  <div class="form-group">
    <label for="title">å…¬å‘Šæ ‡é¢˜ *</label>
    <input type="text" id="title" name="title" required maxlength="200">
  </div>
  
  <div class="form-group">
    <label for="content">å…¬å‘Šå†…å®¹ *</label>
    <textarea id="content" name="content" required></textarea>
  </div>
  
  <!-- æ—¶é—´æ®µè®¾ç½® -->
  <div class="form-group">
    <label>ç”Ÿæ•ˆæ—¶é—´æ®µ</label>
    <div class="time-range">
      <div class="form-group">
        <label for="startDate">å¼€å§‹æ—¥æœŸ</label>
        <input type="date" id="startDate" name="startDate">
      </div>
      <div class="form-group">
        <label for="endDate">ç»“æŸæ—¥æœŸ</label>
        <input type="date" id="endDate" name="endDate">
      </div>
    </div>
    <div class="form-hint">
      <small>ä¸å¡«å†™æ—¶é—´åˆ™åˆ›å»ºæ°¸ä¹…å…¬å‘Š</small>
    </div>
  </div>
  
  <!-- å…¶ä»–å­—æ®µ -->
  <div class="form-group">
    <label for="type">å…¬å‘Šç±»å‹</label>
    <select id="type" name="type">
      <option value="info">ä¿¡æ¯</option>
      <option value="warning">è­¦å‘Š</option>
      <option value="error">é”™è¯¯</option>
      <option value="success">æˆåŠŸ</option>
    </select>
  </div>
  
  <div class="form-group">
    <label for="priority">ä¼˜å…ˆçº§</label>
    <input type="number" id="priority" name="priority" min="0" max="10" value="0">
  </div>
  
  <div class="form-group">
    <label>
      <input type="checkbox" id="isSticky" name="isSticky">
      ç½®é¡¶æ˜¾ç¤º
    </label>
  </div>
</form>
```

### 2. JavaScriptå¤„ç†

#### æ•°æ®æäº¤å¤„ç†
```javascript
// æäº¤å…¬å‘Šè¡¨å•
function submitNoticeForm() {
  const formData = new FormData(document.getElementById('noticeForm'));
  
  // æ„å»ºè¯·æ±‚æ•°æ®
  const noticeData = {
    title: formData.get('title'),
    content: formData.get('content'),
    type: formData.get('type') || 'info',
    priority: parseInt(formData.get('priority')) || 0,
    isSticky: formData.get('isSticky') === 'on'
  };
  
  // å¤„ç†æ—¶é—´æ®µ
  const startDate = formData.get('startDate');
  const endDate = formData.get('endDate');
  
  if (startDate) {
    noticeData.startDate = startDate;
  }
  if (endDate) {
    noticeData.endDate = endDate;
  }
  
  // å‘é€è¯·æ±‚
  fetch('/api/admin/notices', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${getToken()}`
    },
    body: JSON.stringify(noticeData)
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      alert('å…¬å‘Šåˆ›å»ºæˆåŠŸ');
      // åˆ·æ–°åˆ—è¡¨æˆ–è·³è½¬
    } else {
      alert('åˆ›å»ºå¤±è´¥ï¼š' + data.message);
    }
  })
  .catch(error => {
    console.error('Error:', error);
    alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
  });
}
```

#### æ—¥æœŸéªŒè¯
```javascript
// æ—¥æœŸéªŒè¯å‡½æ•°
function validateDateRange() {
  const startDate = document.getElementById('startDate').value;
  const endDate = document.getElementById('endDate').value;
  
  if (startDate && endDate) {
    if (new Date(startDate) > new Date(endDate)) {
      alert('å¼€å§‹æ—¥æœŸä¸èƒ½æ™šäºç»“æŸæ—¥æœŸ');
      return false;
    }
  }
  
  return true;
}

// ç»‘å®šéªŒè¯äº‹ä»¶
document.getElementById('startDate').addEventListener('change', validateDateRange);
document.getElementById('endDate').addEventListener('change', validateDateRange);
```

### 3. åˆ—è¡¨æ˜¾ç¤º

#### å…¬å‘Šåˆ—è¡¨é¡¹
```html
<div class="notice-item">
  <div class="notice-header">
    <h3 class="notice-title">æ˜¥èŠ‚æ”¾å‡é€šçŸ¥</h3>
    <span class="notice-type info">ä¿¡æ¯</span>
    <span class="notice-priority">ä¼˜å…ˆçº§: 3</span>
  </div>
  
  <div class="notice-content">
    æ ¹æ®å›½å®¶æ³•å®šèŠ‚å‡æ—¥å®‰æ’ï¼Œç³»ç»Ÿå°†äºæ˜¥èŠ‚æœŸé—´æš‚åœæœåŠ¡...
  </div>
  
  <div class="notice-meta">
    <div class="notice-time">
      <span class="time-label">ç”Ÿæ•ˆæ—¶é—´ï¼š</span>
      <span class="time-range">2025-02-10 è‡³ 2025-02-17</span>
    </div>
    <div class="notice-status">
      <span class="status published">å·²å‘å¸ƒ</span>
      <span class="sticky">ç½®é¡¶</span>
    </div>
  </div>
  
  <div class="notice-actions">
    <button onclick="editNotice('notice-001')">ç¼–è¾‘</button>
    <button onclick="deleteNotice('notice-001')">åˆ é™¤</button>
  </div>
</div>
```

#### æ—¶é—´æ˜¾ç¤ºå¤„ç†
```javascript
// æ ¼å¼åŒ–æ—¶é—´æ˜¾ç¤º
function formatNoticeTime(startTime, endTime) {
  if (!startTime && !endTime) {
    return 'æ°¸ä¹…æœ‰æ•ˆ';
  }
  
  const start = new Date(startTime);
  const end = new Date(endTime);
  
  const startStr = start.toLocaleDateString('zh-CN');
  const endStr = end.toLocaleDateString('zh-CN');
  
  if (startStr === endStr) {
    return startStr; // åŒä¸€å¤©
  } else {
    return `${startStr} è‡³ ${endStr}`;
  }
}
```

---

## ğŸ“ æ•°æ®æ ¼å¼è¯´æ˜

### æ—¥æœŸæ ¼å¼è¦æ±‚
- **è¾“å…¥æ ¼å¼**ï¼š`YYYY-MM-DD`ï¼ˆå¦‚ï¼š2025-01-27ï¼‰
- **ç³»ç»Ÿå¤„ç†**ï¼š
  - å¼€å§‹æ—¥æœŸ â†’ `YYYY-MM-DD 00:00:00`
  - ç»“æŸæ—¥æœŸ â†’ `YYYY-MM-DD 23:59:59`
- **è¿”å›æ ¼å¼**ï¼šISO8601æ ¼å¼ï¼ˆå¦‚ï¼š2025-01-27T00:00:00.000Zï¼‰

### å­—æ®µæ˜ å°„å…³ç³»
| å‰ç«¯å­—æ®µ | åç«¯å­—æ®µ | è¯´æ˜ |
|----------|----------|------|
| startDate | startTime | å¼€å§‹æ—¶é—´ï¼ˆè‡ªåŠ¨æ·»åŠ  00:00:00ï¼‰ |
| endDate | endTime | ç»“æŸæ—¶é—´ï¼ˆè‡ªåŠ¨æ·»åŠ  23:59:59ï¼‰ |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ—¶é—´å¤„ç†
- ç³»ç»Ÿä¼šè‡ªåŠ¨å°†æ—¥æœŸè½¬æ¢ä¸ºå®Œæ•´çš„æ—¥æœŸæ—¶é—´
- å¼€å§‹æ—¶é—´é»˜è®¤ä¸ºå½“å¤©çš„ 00:00:00
- ç»“æŸæ—¶é—´é»˜è®¤ä¸ºå½“å¤©çš„ 23:59:59

### 2. éªŒè¯è§„åˆ™
- å¼€å§‹æ—¥æœŸä¸èƒ½æ™šäºç»“æŸæ—¥æœŸ
- æ—¥æœŸæ ¼å¼å¿…é¡»ä¸º YYYY-MM-DD
- å¦‚æœåªå¡«å†™ä¸€ä¸ªæ—¥æœŸï¼Œå¦ä¸€ä¸ªé»˜è®¤ä¸ºåŒä¸€å¤©

### 3. ç”¨æˆ·ä½“éªŒ
- å»ºè®®ä½¿ç”¨æ—¥æœŸé€‰æ‹©å™¨è€Œä¸æ˜¯æ–‡æœ¬è¾“å…¥
- æä¾›"æ°¸ä¹…å…¬å‘Š"é€‰é¡¹ï¼ˆä¸å¡«å†™æ—¶é—´ï¼‰
- åœ¨ç•Œé¢ä¸Šæ¸…æ¥šæ˜¾ç¤ºå…¬å‘Šçš„æœ‰æ•ˆæœŸ

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•åˆ›å»ºæ°¸ä¹…å…¬å‘Šï¼Ÿ
A: ä¸å¡«å†™ startDate å’Œ endDate å­—æ®µå³å¯ã€‚

### Q2: å¦‚ä½•åˆ›å»ºå•æ—¥å…¬å‘Šï¼Ÿ
A: å°† startDate å’Œ endDate è®¾ç½®ä¸ºåŒä¸€å¤©ã€‚

### Q3: æ—¶é—´æ ¼å¼æœ‰ä»€ä¹ˆè¦æ±‚ï¼Ÿ
A: å¿…é¡»ä½¿ç”¨ YYYY-MM-DD æ ¼å¼ï¼Œå¦‚ï¼š2025-01-27ã€‚

### Q4: ç³»ç»Ÿå¦‚ä½•å¤„ç†æ—¶åŒºï¼Ÿ
A: ç³»ç»Ÿä½¿ç”¨ UTC æ—¶é—´ï¼Œå‰ç«¯æ˜¾ç¤ºæ—¶ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´ã€‚

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜è¯·è”ç³»åç«¯å¼€å‘å›¢é˜Ÿæˆ–æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚

---

**æ³¨æ„**: æœ¬æ–‡æ¡£ä¸“é—¨ä¸ºå‰ç«¯å¼€å‘äººå‘˜è®¾è®¡ï¼Œç®€åŒ–äº†æ—¶é—´è¾“å…¥è¦æ±‚ï¼Œåªéœ€è¦å¡«å†™æ—¥æœŸå³å¯å®ç°æ—¶é—´æ®µå…¬å‘ŠåŠŸèƒ½ã€‚
