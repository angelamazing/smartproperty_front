<!DOCTYPE html>
<html>
<head>
    <title>iOSæ—¥æœŸä¿®å¤æµ‹è¯•</title>
    <style>
        body{font-family:Arial;max-width:600px;margin:20px auto;padding:20px}
        .btn{background:#007bff;color:white;border:none;padding:8px 16px;margin:5px;border-radius:4px;cursor:pointer}
        .log{background:#f5f5f5;padding:10px;height:200px;overflow-y:auto;font-family:monospace;font-size:12px}
        .success{color:green} .error{color:red}
    </style>
</head>
<body>
    <h1>iOSæ—¥æœŸå…¼å®¹æ€§ä¿®å¤æµ‹è¯•</h1>
    <p>æµ‹è¯• "9/13/2025, 7:19:58 AM" æ ¼å¼</p>
    
    <button class="btn" onclick="test()">è¿è¡Œæµ‹è¯•</button>
    <button class="btn" onclick="clearLog()">æ¸…ç©º</button>
    
    <div class="log" id="log">ç­‰å¾…æµ‹è¯•...</div>
    
    <script>
        const formats = ["9/13/2025, 7:19:58 AM", "1/1/2026, 12:00:00 AM"];
        let originalDate = Date;
        
        function log(msg) {
            document.getElementById('log').innerHTML += new Date().toLocaleTimeString() + ' - ' + msg + '<br>';
        }
        
        function clearLog() { document.getElementById('log').innerHTML = ''; }
        
        function applyFix() {
            window.Date = function(...args) {
                if (args.length === 1 && typeof args[0] === 'string') {
                    const str = args[0];
                    const match = str.match(/(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4}),?\\s*(\\d{1,2}):(\\d{1,2}):(\\d{1,2})\\s*(AM|PM)/i);
                    if (match) {
                        let [,m,d,y,h,min,s,ap] = match;
                        let hour = parseInt(h);
                        if (ap.toUpperCase() === 'PM' && hour !== 12) hour += 12;
                        if (ap.toUpperCase() === 'AM' && hour === 12) hour = 0;
                        const iso = `${y}-${m.padStart(2,'0')}-${d.padStart(2,'0')}T${hour.toString().padStart(2,'0')}:${min.padStart(2,'0')}:${s.padStart(2,'0')}`;
                        log(`è½¬æ¢: "${str}" â†’ "${iso}"`);
                        return new originalDate(iso);
                    }
                }
                return new originalDate(...args);
            };
            Object.setPrototypeOf(window.Date, originalDate);
            window.Date.prototype = originalDate.prototype;
        }
        
        function test() {
            log('åº”ç”¨ä¿®å¤...');
            applyFix();
            
            let success = 0;
            formats.forEach((fmt, i) => {
                try {
                    const date = new Date(fmt);
                    if (!isNaN(date.getTime())) {
                        log(`<span class="success">âœ… æµ‹è¯•${i+1}: æˆåŠŸ â†’ ${date.toISOString()}</span>`);
                        success++;
                    } else {
                        log(`<span class="error">âŒ æµ‹è¯•${i+1}: å¤±è´¥</span>`);
                    }
                } catch(e) {
                    log(`<span class="error">âŒ æµ‹è¯•${i+1}: å¼‚å¸¸ ${e.message}</span>`);
                }
            });
            
            const rate = Math.round(success/formats.length*100);
            log(`<strong>ç»“æœ: ${success}/${formats.length} (${rate}%) ${rate===100?'ğŸ‰å®Œå…¨æˆåŠŸ':'âš ï¸éƒ¨åˆ†æˆåŠŸ'}</strong>`);
        }
    </script>
</body>
</html>